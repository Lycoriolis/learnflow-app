var I=(U,b,o)=>new Promise((t,d)=>{var n=r=>{try{_(o.next(r))}catch(p){d(p)}},m=r=>{try{_(o.throw(r))}catch(p){d(p)}},_=r=>r.done?t(r.value):Promise.resolve(r.value).then(n,m);_((o=o.apply(U,b)).next())});import"./COm6N4YE.js";import"./69_IOA4Y.js";import{p as O,m as $,l as re,s as v,ah as ae,a as se,d as u,g as e,r as i,b as P,c as D,e as S,t as H,f as ie}from"./HPQed-Yx.js";import{t as M,a as E,e as C,r as oe}from"./ZM6Rlk1U.js";import{p as Q}from"./BWjJF4ZV.js";import{M as ne}from"./D-UabZxA.js";import{s as B}from"./PqlH_gqs.js";import{i as T}from"./Da7F0fHf.js";import{e as G,i as J}from"./ErG-rR4v.js";import{b as ce}from"./D8Qc2aSm.js";import{i as de}from"./D0cPXSkH.js";import{o as le}from"./Bpt9IQqH.js";import{a as K,g as L,d as W,e as ue,s as ve,u as me,j as z}from"./D8i9UXqZ.js";import{I as N}from"./BC8mezXZ.js";var fe=M('<div class="exercise-markdown svelte-1y8xbh2"><!></div>');function qe(U,b){O(b,!1);let o=Q(b,"markdown",8,""),t=$(o());function d(_){let r=_.replace(/\$\$(.*?)\$\$/g,(p,y)=>`<div class="math-block">${y}</div>`);return r=r.replace(/\$(.*?)\$/g,(p,y)=>`<span class="math-inline">${y}</span>`),r=r.replace(/```exercise([\s\S]*?)```/g,(p,y)=>`<div class="code-exercise-container">
\`\`\`${y}\`\`\`
</div>`),r}re(()=>ae(o()),()=>{v(t,d(o()))}),se();var n=fe(),m=u(n);ne(m,{get content(){return e(t)}}),i(n),E(U,n),P()}var xe=M('<button class="text-2xl focus:outline-none"><!></button>'),ge=M('<div class="mt-2"><textarea class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-md bg-surface dark:bg-surface-dark text-text dark:text-text-light focus:ring-cherry-500 focus:border-cherry-500 min-h-[80px]" placeholder="What did you think about this exercise?"></textarea></div>'),pe=M('<div class="flex flex-col space-y-4"><div class="flex items-center space-x-1"></div> <div><button class="text-sm text-cherry-600 dark:text-cherry-400 hover:underline"> </button> <!></div> <div><button class="px-4 py-2 text-sm font-medium rounded-md bg-cherry-600 text-white hover:bg-cherry-700 dark:bg-cherry-500 dark:hover:bg-cherry-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">Submit Rating</button></div></div>'),he=M('<div class="mt-2 text-sm text-gray-600 dark:text-gray-400"><p class="italic"> </p></div>'),be=M('<div class="flex items-center justify-between"><div class="flex items-center space-x-1"></div> <button class="text-sm text-cherry-600 dark:text-cherry-400 hover:underline">Edit Rating</button></div> <!>',1),_e=M('<div class="exercise-rating"><h3 class="text-lg font-semibold mb-2">Rate this exercise</h3> <!></div>');function He(U,b){O(b,!1);let o=Q(b,"exerciseId",8),t=$(null),d=$(!1),n=$(""),m=$(!1);le(()=>I(null,null,function*(){yield _()}));function _(){return I(this,null,function*(){const s=K();if(s.currentUser)try{const a=L(),l=W(a,"users",s.currentUser.uid,"ratings",o()),c=yield ue(l);if(c.exists()){const f=c.data();v(t,f.rating),v(n,f.feedback||""),v(d,!0)}}catch(a){console.error("Error loading rating:",a)}})}function r(){return I(this,null,function*(){if(e(t)===null)return;const s=K();if(s.currentUser)try{const a=L(),l=W(a,"users",s.currentUser.uid,"ratings",o());yield ve(l,{rating:e(t),feedback:e(n),timestamp:new Date});const c=W(a,"exercises",o());yield me(c,{ratingSum:z(e(t)),ratingCount:z(1),averageRating:z(0)}),v(d,!0),v(m,!1)}catch(a){console.error("Error submitting rating:",a)}})}function p(s){e(d)||v(t,s)}function y(){v(d,!1)}de();var j=_e(),V=D(u(j),2);{var X=s=>{var a=pe(),l=u(a);G(l,4,()=>Array(5),J,(x,g,A)=>{var R=xe(),Z=u(R);const ee=S(()=>e(t)&&A<e(t)?"mdi:star":"mdi:star-outline"),te=S(()=>e(t)&&A<e(t)?"text-yellow-400":"text-gray-400 hover:text-yellow-400");N(Z,{get icon(){return e(ee)},get class(){return e(te)},width:"28",height:"28"}),i(R),H(()=>R.disabled=e(d)),C("click",R,()=>p(A+1)),E(x,R)}),i(l);var c=D(l,2),f=u(c),F=u(f,!0);i(f);var q=D(f,2);{var k=x=>{var g=ge(),A=u(g);oe(A),i(g),ce(A,()=>e(n),R=>v(n,R)),E(x,g)};T(q,x=>{e(m)&&x(k)})}i(c);var w=D(c,2),h=u(w);i(w),i(a),H(()=>{B(F,e(m)?"Hide feedback form":"Add feedback (optional)"),h.disabled=e(t)===null}),C("click",f,()=>v(m,!e(m))),C("click",h,r),E(s,a)},Y=s=>{var a=be(),l=ie(a),c=u(l);G(c,4,()=>Array(5),J,(k,w,h)=>{const x=S(()=>e(t)&&h<e(t)?"mdi:star":"mdi:star-outline"),g=S(()=>e(t)&&h<e(t)?"text-yellow-400":"text-gray-400");N(k,{get icon(){return e(x)},get class(){return e(g)},width:"24",height:"24"})}),i(c);var f=D(c,2);i(l);var F=D(l,2);{var q=k=>{var w=he(),h=u(w),x=u(h);i(h),i(w),H(()=>{var g;return B(x,`"${(g=e(n))!=null?g:""}"`)}),E(k,w)};T(F,k=>{e(n)&&k(q)})}C("click",f,y),E(s,a)};T(V,s=>{e(d)?s(Y,!1):s(X)})}i(j),E(U,j),P()}export{qe as E,He as a};
//# sourceMappingURL=B0eKqkWg.js.map
