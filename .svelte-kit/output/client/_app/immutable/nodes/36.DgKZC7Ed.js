import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as Q,t as w,g as e,b as Z,$ as ee,e as p,c as l,j as te,m as g,s as o,at as ae,r as d}from"../chunks/D8Zr53n5.js";import{s as q}from"../chunks/UpSy6tP0.js";import{i as z}from"../chunks/BAqAra_5.js";import{e as D,i as F}from"../chunks/8AErAcLY.js";import{t as u,a as b}from"../chunks/ByokzzJe.js";import{h as re,e as $,r as oe}from"../chunks/CCLz0Z0F.js";import{s as j}from"../chunks/Cw_GgyMt.js";import{b as se}from"../chunks/Djn-aou_.js";import{b as ie}from"../chunks/BM8m5GYV.js";import{i as de}from"../chunks/BzVavbfz.js";import{o as le,a as ne,b as ve}from"../chunks/DyX_nzx0.js";import{M as pe}from"../chunks/DYIbtIuY.js";import{l as ge,a as ce,b as be}from"../chunks/C44GRa1C.js";var ue=u("<button> </button>"),fe=u("<div><div><!></div></div>"),me=u('<div class="flex justify-start mb-3 svelte-b8plu3"><div class="loading-dot bg-gray-400 dark:bg-gray-600 svelte-b8plu3"></div> <div class="loading-dot bg-gray-400 dark:bg-gray-600 svelte-b8plu3"></div> <div class="loading-dot bg-gray-400 dark:bg-gray-600 svelte-b8plu3"></div></div>'),xe=u('<div class="text-red-500 text-sm svelte-b8plu3"> </div>'),ye=u('<div class="max-w-2xl mx-auto px-4 py-10 flex flex-col h-[75vh] svelte-b8plu3"><h1 class="text-2xl font-bold text-gray-900 dark:text-white mb-4 svelte-b8plu3">AI Study Chat</h1> <div class="flex space-x-4 mb-4 svelte-b8plu3"></div> <div class="flex-1 overflow-y-auto space-y-4 p-4 bg-white dark:bg-gray-800 rounded-lg shadow-inner svelte-b8plu3" id="chat-window"><!> <!> <!></div> <div class="mt-4 flex svelte-b8plu3"><textarea class="flex-1 rounded-lg border border-gray-300 dark:border-gray-600 p-2 resize-none focus:ring-2 focus:ring-indigo-400 focus:border-indigo-400 transition bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 svelte-b8plu3" rows="2" placeholder="Type your question..."></textarea> <button class="ml-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg shadow transition disabled:opacity-50 svelte-b8plu3">Send</button></div></div>');function Re(H,K){Q(K,!1);const N="https://openrouter.ai/api/v1/chat/completions",O="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",B="http://localhost:5173",J="LearnFlow",M=[{id:"assist",label:"Assist Mode",model:"google/learnlm-1.5-pro-experimental:free"},{id:"support",label:"Support Mode",model:"google/gemini-2.5-pro-exp-03-25:free"}];let k=g("assist"),c=g([]),s=g(""),f=g(!1),m=g(""),n=g(),A=null;le(async()=>{A=await ge("view_chat","chat")}),ne(()=>{A&&ce(A)}),ve(()=>{e(n)&&ae(n,e(n).scrollTop=e(n).scrollHeight)});async function C(){var r,i,h;if(!e(s).trim())return;await be("send_message","chat",{content:e(s)}),o(c,[...e(c),{role:"user",text:e(s)}]);const t=e(s);o(s,""),o(f,!0),o(m,"");const a=M.find(v=>v.id===e(k));try{const v={model:a.model,messages:[{role:"user",content:[{type:"text",text:t}]}]},T=await fetch(N,{method:"POST",headers:{Authorization:`Bearer ${O}`,"HTTP-Referer":B,"X-Title":J,"Content-Type":"application/json"},body:JSON.stringify(v)});if(!T.ok)throw new Error(await T.text());const Y=await T.json();let I="";const _=(h=(i=(r=Y.choices)==null?void 0:r[0])==null?void 0:i.message)==null?void 0:h.content;typeof _=="string"?I=_:Array.isArray(_)&&(I=_.map(G=>G.text||"").join(" ")),o(c,[...e(c),{role:"assistant",text:I}])}catch(v){console.error(v),o(m,v.message||"Error fetching AI response")}finally{o(f,!1)}}de();var E=ye();re(t=>{ee.title="AI Study Chat | LearnFlow"});var S=p(l(E),2);D(S,5,()=>M,F,(t,a)=>{var r=ue(),i=l(r,!0);d(r),w(()=>{j(r,1,`px-4 py-2 rounded-lg font-semibold transition 
          ${(e(k)===e(a).id?"bg-indigo-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600")??""}`,"svelte-b8plu3"),q(i,e(a).label)}),$("click",r,()=>o(k,e(a).id)),b(t,r)}),d(S);var x=p(S,2),L=l(x);D(L,1,()=>e(c),F,(t,a)=>{var r=fe(),i=l(r),h=l(i);pe(h,{get content(){return e(a).text}}),d(i),d(r),w(()=>{j(r,1,`flex ${(e(a).role==="assistant"?"justify-start":"justify-end")??""}`,"svelte-b8plu3"),j(i,1,`max-w-[80%] p-3 prose dark:prose-invert 
          ${(e(a).role==="assistant"?"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-gray-100 rounded-tr-xl rounded-br-xl rounded-tl-xl":"bg-indigo-600 dark:bg-indigo-500 text-white rounded-tl-xl rounded-bl-xl rounded-br-xl")??""}`,"svelte-b8plu3")}),b(t,r)});var P=p(L,2);{var V=t=>{var a=me();b(t,a)};z(P,t=>{e(f)&&t(V)})}var W=p(P,2);{var X=t=>{var a=xe(),r=l(a,!0);d(a),w(()=>q(r,e(m))),b(t,a)};z(W,t=>{e(m)&&t(X)})}d(x),ie(x,t=>o(n,t),()=>e(n));var R=p(x,2),y=l(R);oe(y);var U=p(y,2);d(R),d(E),w(t=>U.disabled=t,[()=>e(f)||!e(s).trim()],te),se(y,()=>e(s),t=>o(s,t)),$("keydown",y,t=>t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),C())),$("click",U,C),b(H,E),Z()}export{Re as component};
