{"version":3,"file":"35.D-T1Gzmi.js","sources":["../../../../../../src/lib/components/ResetPassword.svelte","../../../../../../src/routes/reset-password/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n  import { resetPassword } from '$lib/authService.js';\n  import { loading, authError, isAuthenticated } from '$lib/stores/authStore.js';\n  import { onMount } from 'svelte';\n  import { browser } from '$app/environment';\n  import { goto } from '$app/navigation';\n  \n  export let redirectTo = '/login';\n  \n  let email = '';\n  let localError = '';\n  let successMessage = '';\n  let isSubmitting = false;\n  let validationErrors: {email?: string} = {};\n  \n  onMount(() => {\n    if (browser && $isAuthenticated) {\n      // If already authenticated, redirect to home\n      goto('/');\n    }\n    \n    // Clear any previous auth errors when component mounts\n    authError.set('');\n  });\n  \n  function validateEmail(email: string): boolean {\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    const isValid = emailRegex.test(email);\n    \n    if (!isValid) {\n      validationErrors.email = 'Please enter a valid email address';\n    } else {\n      validationErrors.email = undefined;\n    }\n    \n    validationErrors = validationErrors; // Trigger reactivity\n    return isValid;\n  }\n  \n  async function handleResetPassword(e: SubmitEvent) {\n    if (!browser) return;\n    \n    e.preventDefault();\n    isSubmitting = true;\n    localError = '';\n    successMessage = '';\n    authError.set('');\n    \n    if (!validateEmail(email)) {\n      isSubmitting = false;\n      return;\n    }\n    \n    try {\n      await resetPassword(email);\n      successMessage = 'Password reset email sent. Check your inbox for further instructions.';\n      email = ''; // Clear form after successful submission\n    } catch (err) {\n      // Handle specific error messages\n      if (err instanceof Error) {\n        const errorMessage = err.message;\n        if (errorMessage.includes('user-not-found')) {\n          localError = 'No account found with this email address.';\n        } else if (errorMessage.includes('too-many-requests')) {\n          localError = 'Too many requests. Please try again later.';\n        } else {\n          localError = 'Failed to send reset email. Please try again later.';\n        }\n      } else {\n        localError = 'An unexpected error occurred. Please try again later.';\n      }\n    } finally {\n      isSubmitting = false;\n    }\n  }\n</script>\n\n<div class=\"w-full max-w-md mx-auto p-6 bg-white dark:bg-gray-800 rounded-lg shadow-md\">\n  <h2 class=\"text-2xl font-bold mb-6 text-center text-gray-800 dark:text-white\">Reset Password</h2>\n  \n  {#if $authError}\n    <div class=\"bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-800 text-red-700 dark:text-red-300 px-4 py-3 rounded mb-4\" role=\"alert\">\n      <span class=\"block sm:inline\">{$authError}</span>\n    </div>\n  {/if}\n  \n  {#if localError}\n    <div class=\"bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-800 text-red-700 dark:text-red-300 px-4 py-3 rounded mb-4\" role=\"alert\">\n      <span class=\"block sm:inline\">{localError}</span>\n    </div>\n  {/if}\n  \n  {#if successMessage}\n    <div class=\"bg-green-100 dark:bg-green-900/30 border border-green-400 dark:border-green-800 text-green-700 dark:text-green-300 px-4 py-3 rounded mb-4\" role=\"alert\">\n      <span class=\"block sm:inline\">{successMessage}</span>\n      <div class=\"mt-2\">\n        <a href=\"/login\" class=\"font-medium text-green-700 dark:text-green-300 underline\">Return to login</a>\n      </div>\n    </div>\n  {/if}\n  \n  {#if !successMessage}\n    <form on:submit={handleResetPassword} class=\"space-y-4\">\n      <div>\n        <label for=\"email\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Email</label>\n        <input \n          type=\"email\" \n          id=\"email\" \n          bind:value={email}\n          on:blur={() => validateEmail(email)}\n          class=\"mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 {validationErrors.email ? 'border-red-500' : ''}\"\n          required\n          autocomplete=\"email\"\n          aria-invalid={validationErrors.email ? 'true' : 'false'}\n          aria-describedby={validationErrors.email ? 'email-error' : 'email-help'}\n        />\n        <p id=\"email-help\" class=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">We'll send you a link to reset your password</p>\n        {#if validationErrors.email}\n          <p id=\"email-error\" class=\"mt-1 text-sm text-red-600 dark:text-red-400\">{validationErrors.email}</p>\n        {/if}\n      </div>\n      \n      <div>\n        <button \n          type=\"submit\" \n          class=\"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n          disabled={$loading || isSubmitting}\n          aria-busy={$loading || isSubmitting}\n        >\n          {#if $loading || isSubmitting}\n            <span class=\"inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\" aria-hidden=\"true\"></span>\n            <span>Sending...</span>\n          {:else}\n            Send Reset Link\n          {/if}\n        </button>\n      </div>\n    </form>\n  {/if}\n  \n  <div class=\"mt-6 text-center\">\n    <p class=\"text-sm text-gray-600 dark:text-gray-400\">\n      Remember your password? \n      <a href=\"/login\" class=\"font-medium text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300\">\n        Log in\n      </a>\n    </p>\n  </div>\n  \n  <div class=\"mt-4 text-center\">\n    <p class=\"text-sm text-gray-600 dark:text-gray-400\">\n      Don't have an account? \n      <a href=\"/register\" class=\"font-medium text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300\">\n        Sign up\n      </a>\n    </p>\n  </div>\n</div>","<script lang=\"ts\">\n  import ResetPassword from '$lib/components/ResetPassword.svelte';\n  import { loading } from '$lib/stores/authStore.js';\n</script>\n\n<svelte:head>\n  <title>Reset Password - LearnFlow</title>\n</svelte:head>\n\n<div class=\"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8\">\n  {#if $loading}\n    <div class=\"flex flex-col items-center justify-center\">\n      <div class=\"w-16 h-16 border-4 border-t-blue-500 border-blue-200 rounded-full animate-spin\"></div>\n      <p class=\"mt-4 text-gray-600 dark:text-gray-400\">Loading...</p>\n    </div>\n  {:else}\n    <ResetPassword />\n  {/if}\n</div> "],"names":["email","localError","successMessage","isSubmitting","validationErrors","$.mutable_source","onMount","$isAuthenticated","goto","authError","validateEmail","isValid","$.mutate","$.get","$.set","handleResetPassword","e","__async","resetPassword","err","errorMessage","$authError","$$render","consequent","consequent_1","consequent_2","$.template_effect","$.set_text","text_3","consequent_3","$loading","consequent_4","alternate","$.set_class","input","$.set_attribute","button","$.bind_value","$$value","$.event","consequent_5"],"mappings":"q6GAO0B,QAAQ,EAE5B,IAAAA,IAAQ,EAAE,EACVC,IAAa,EAAE,EACfC,IAAiB,EAAE,EACnBC,IAAe,EAAK,EACpBC,EAAkCC,EAAA,EAAA,EAEtCC,GAAc,IAAA,CACGC,EAAgB,GAE7BC,GAAK,GAAG,EAIVC,EAAU,IAAI,EAAE,EACjB,WAEQC,EAAcV,EAAwB,CAEvC,MAAAW,EADa,6BACQ,KAAKX,CAAK,EAEhC,OAAAW,EAGHC,EAAAR,EAAAS,EAAAT,CAAgB,EAAC,MAAQ,MAAS,EAFlCQ,EAAAR,EAAAS,EAAAT,CAAgB,EAAC,MAAQ,oCAAoC,EAK/DU,EAAAV,IAAmBA,CAAgB,CAAA,EAC5BO,CACT,UAEeI,EAAoBC,EAAgB,QAAAC,EAAA,yBAGjDD,EAAE,eAAc,EAChBF,EAAAX,EAAe,EAAI,EACnBW,EAAAb,EAAa,EAAE,EACfa,EAAAZ,EAAiB,EAAE,EACnBO,EAAU,IAAI,EAAE,GAEXC,EAAaG,EAACb,CAAK,CAAG,EAAA,CACzBc,EAAAX,EAAe,EAAK,QAEtB,CAEI,GAAA,CACI,MAAAe,KAAclB,CAAK,CAAA,EACzBc,EAAAZ,EAAiB,uEAAuE,EACxFY,EAAAd,EAAQ,EAAE,CACX,OAAQmB,EAAK,IAERA,aAAe,MAAO,OAClBC,EAAeD,EAAI,QACrBC,EAAa,SAAS,gBAAgB,EACxCN,EAAAb,EAAa,2CAA2C,EAC/CmB,EAAa,SAAS,mBAAmB,EAClDN,EAAAb,EAAa,4CAA4C,EAEzDa,EAAAb,EAAa,qDAAqD,CAEtE,MACEa,EAAAb,EAAa,uDAAuD,CAExE,QAAU,CACRa,EAAAX,EAAe,EAAK,CACtB,CACF,0FAQmCkB,EAAU,CAAA,CAAA,kBAFxCA,EAAU,GAAAC,EAAAC,CAAA,8EAQoBtB,CAAU,CAAA,CAAA,oBAFxCA,CAAU,GAAAqB,EAAAE,CAAA,mFAQoBtB,CAAc,CAAA,CAAA,oBAF5CA,CAAc,GAAAoB,EAAAG,CAAA,mHA0B8DC,EAAA,IAAAC,EAAAC,GAAAf,EAAAT,CAAgB,EAAC,KAAK,CAAA,kBAD5FS,EAAAT,CAAgB,EAAC,OAAKkB,EAAAO,CAAA,2HAYpBC,OAAY3B,CAAY,EAAAmB,EAAAS,EAAA,EAAAT,EAAAU,GAAA,EAAA,0BAnB+JC,GAAAC,EAAA,EAAA,uLAAArB,EAAAT,CAAgB,EAAC,MAAQ,iBAAmB,EAAE,EAAA,EAG5N+B,EAAAD,EAAA,eAAArB,EAAAT,CAAgB,EAAC,MAAQ,OAAS,OAAO,EACrC+B,EAAAD,EAAA,mBAAArB,EAAAT,CAAgB,EAAC,MAAQ,cAAgB,YAAY,EAY7DgC,EAAA,SAAAN,OAAY3B,CAAY,EACvBgC,EAAAC,EAAA,YAAAN,EAAQ,KAAI3B,CAAY,CAAA,IAnBvBkC,GAAAH,EAAA,IAAArB,EAAAb,CAAK,OAALA,EAAKsC,CAAA,CAAA,EACFC,EAAA,OAAAL,EAAA,IAAAxB,IAAcV,CAAK,CAAA,CAAA,eAPvBe,CAAmB,oBADhCb,CAAc,GAAAoB,EAAAkB,CAAA,+jBC3FfV,EAAQ,EAAAR,EAAAC,CAAA,EAAAD,EAAAU,EAAA,EAAA"}