{"version":3,"file":"27.qo80yKzM.js","sources":["../../../../../../src/routes/groups/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n  import { onMount } from 'svelte';\n  import { fade } from 'svelte/transition';\n\n  // Types\n  type UserGroup = {\n    id: string;\n    name: string;\n    description: string;\n    topic: string;\n    image?: string;\n    memberCount: number;\n    isPublic: boolean;\n    createdBy: string;\n    createdAt: string;\n    isMember?: boolean; // Added to track if the current user is a member\n  };\n\n  // User groups data fetched from API\n  let allGroups: UserGroup[] = [];\n\n  // Filter and search state\n  let searchQuery = '';\n  let selectedTopic = 'all';\n\n  // Extract unique topics for filtering (computed after fetch)\n  $: groupTopics = [\n    'all',\n    ...Array.from(new Set(allGroups.map(group => group.topic)))\n  ];\n\n  // Filtered and searched groups\n  $: filteredGroups = allGroups.filter(group => {\n    const matchesTopic = selectedTopic === 'all' || group.topic === selectedTopic;\n    const matchesSearch = searchQuery === '' || \n      group.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      group.description.toLowerCase().includes(searchQuery.toLowerCase());\n    return matchesTopic && matchesSearch;\n  });\n\n  // Separate groups the user is a member of\n  $: myGroups = allGroups.filter(group => group.isMember);\n  $: discoverGroups = filteredGroups.filter(group => !group.isMember);\n\n  // Function to handle joining/leaving a group\n  async function toggleGroupMembership(groupId: string, isMember: boolean) {\n    try {\n      const endpoint = isMember ? '/api/groups/leave' : '/api/groups/join';\n      const res = await fetch(endpoint, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ group_id: groupId })\n      });\n      if (res.ok) {\n        const groupIndex = allGroups.findIndex(g => g.id == groupId || g.id === groupId);\n        if (groupIndex !== -1) {\n          allGroups[groupIndex].isMember = !isMember;\n          allGroups = [...allGroups];\n        }\n      } else {\n        alert('Failed to update group membership.');\n      }\n    } catch (e) {\n      alert('Error updating group membership.');\n    }\n  }\n\n  // Loading state\n  let loading = true;\n\n  onMount(async () => {\n    loading = true;\n    try {\n      const res = await fetch('/api/groups/');\n      if (res.ok) {\n        allGroups = await res.json();\n      } else {\n        allGroups = [];\n      }\n    } catch (e) {\n      allGroups = [];\n    } finally {\n      loading = false;\n    }\n  });\n\n  function handleJoin(id: string) {\n    toggleGroupMembership(id, false);\n  }\n\n  function handleLeave(id: string) {\n    toggleGroupMembership(id, true);\n  }\n</script>\n\n<svelte:head>\n  <title>User Groups | LearnFlow</title>\n</svelte:head>\n\n<div class=\"container mx-auto px-4 py-8 max-w-7xl\">\n  {#if loading}\n    <div class=\"flex justify-center items-center h-64\">\n      <div class=\"loader\"></div>\n    </div>\n  {:else}\n    <div in:fade={{ duration: 300 }}>\n      <!-- Header Section -->\n      <div class=\"flex flex-col md:flex-row justify-between items-start md:items-center mb-8\">\n        <div>\n          <h1 class=\"text-3xl font-bold text-gray-900 dark:text-white mb-2\">Study Groups</h1>\n          <p class=\"text-gray-600 dark:text-gray-400\">Connect, collaborate, and learn with fellow students</p>\n        </div>\n        \n        <div class=\"mt-4 md:mt-0\">\n          <a \n            href=\"/groups/create\" \n            class=\"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-md text-sm font-medium flex items-center transition-colors\"\n          >\n            <i class=\"fas fa-plus mr-2\"></i>\n            Create New Group\n          </a>\n        </div>\n      </div>\n      \n      <!-- Search and Filter Bar -->\n      <div class=\"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700 p-4 mb-8\">\n        <div class=\"flex flex-col md:flex-row gap-4\">\n          <div class=\"relative flex-grow\">\n            <input \n              type=\"text\" \n              class=\"w-full pl-10 pr-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500\"\n              placeholder=\"Search groups by name or description...\"\n              bind:value={searchQuery}\n            />\n            <div class=\"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none\">\n              <i class=\"fas fa-search text-gray-400\"></i>\n            </div>\n          </div>\n          \n          <div class=\"relative\">\n            <select\n              class=\"appearance-none pl-4 pr-10 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 min-w-[180px]\"\n              bind:value={selectedTopic}\n            >\n              {#each groupTopics as topic}\n                <option value={topic}>{topic === 'all' ? 'All Topics' : topic}</option>\n              {/each}\n            </select>\n            <div class=\"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none\">\n              <i class=\"fas fa-chevron-down text-gray-400\"></i>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- My Groups Section -->\n      {#if myGroups.length > 0}\n        <div class=\"mb-12\">\n          <h2 class=\"text-2xl font-bold text-gray-900 dark:text-white mb-4\">My Groups</h2>\n          <div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {#each myGroups as group (group.id)}\n              <div class=\"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden flex flex-col\">\n                {#if group.image}\n                  <img src={group.image} alt={group.name} class=\"w-full h-32 object-cover\"/>\n                {:else}\n                  <div class=\"w-full h-32 bg-gradient-to-r from-indigo-100 to-purple-100 dark:from-indigo-900/30 dark:to-purple-900/30 flex items-center justify-center\">\n                     <i class=\"fas fa-users text-4xl text-indigo-400 dark:text-indigo-600\"></i>\n                  </div>\n                {/if}\n                <div class=\"p-5 flex-1 flex flex-col\">\n                  <h3 class=\"text-lg font-semibold text-gray-900 dark:text-white mb-1\">{group.name}</h3>\n                  <p class=\"text-sm text-gray-500 dark:text-gray-400 mb-3\">Topic: {group.topic}</p>\n                  <p class=\"text-sm text-gray-600 dark:text-gray-300 mb-4 line-clamp-2 flex-1\">{group.description}</p>\n                  <div class=\"flex justify-between items-center text-xs text-gray-500 dark:text-gray-400 mb-4\">\n                    <span><i class=\"fas fa-users mr-1\"></i> {group.memberCount} members</span>\n                    <span>{group.isPublic ? 'Public' : 'Private'}</span>\n                  </div>\n                  <div class=\"mt-auto flex gap-2\">\n                     <a href=\"/groups/{group.id}\" class=\"flex-1 text-center px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-md text-sm font-medium transition-colors\">\n                       View Group\n                     </a>\n                     <button \n                       on:click={() => handleLeave(group.id)}\n                       class=\"px-3 py-2 bg-red-100 hover:bg-red-200 dark:bg-red-900/30 dark:hover:bg-red-900/50 text-red-700 dark:text-red-300 rounded-md text-sm font-medium transition-colors\"\n                       title=\"Leave Group\"\n                     >\n                       <i class=\"fas fa-sign-out-alt\"></i>\n                     </button>\n                  </div>\n                </div>\n              </div>\n            {/each}\n          </div>\n        </div>\n      {/if}\n\n      <!-- Discover Groups Section -->\n      <div>\n        <h2 class=\"text-2xl font-bold text-gray-900 dark:text-white mb-4\">\n          {searchQuery || selectedTopic !== 'all' ? 'Filtered Groups' : 'Discover Groups'}\n        </h2>\n        {#if discoverGroups.length === 0}\n          <div class=\"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700 p-8 text-center\">\n            <div class=\"w-16 h-16 mx-auto bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center mb-4\">\n              <i class=\"fas fa-search text-gray-400 dark:text-gray-500 text-2xl\"></i>\n            </div>\n            <h3 class=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">No groups found</h3>\n            <p class=\"text-gray-600 dark:text-gray-400 mb-6\">\n              {#if searchQuery || selectedTopic !== 'all'}\n                Try adjusting your search or filter criteria.\n              {:else}\n                There are no available groups to join right now. Why not create one?\n              {/if}\n            </p>\n            {#if searchQuery || selectedTopic !== 'all'}\n              <button \n                class=\"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-md text-sm font-medium transition-colors\"\n                on:click={() => { searchQuery = ''; selectedTopic = 'all'; }}\n              >\n                Clear Filters\n              </button>\n            {:else}\n               <a \n                href=\"/groups/create\" \n                class=\"inline-flex items-center px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-md text-sm font-medium transition-colors\"\n              >\n                <i class=\"fas fa-plus mr-2\"></i>\n                Create New Group\n              </a>\n            {/if}\n          </div>\n        {:else}\n          <div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {#each discoverGroups as group (group.id)}\n              <div class=\"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden flex flex-col\">\n                 {#if group.image}\n                  <img src={group.image} alt={group.name} class=\"w-full h-32 object-cover\"/>\n                {:else}\n                  <div class=\"w-full h-32 bg-gradient-to-r from-indigo-100 to-purple-100 dark:from-indigo-900/30 dark:to-purple-900/30 flex items-center justify-center\">\n                     <i class=\"fas fa-users text-4xl text-indigo-400 dark:text-indigo-600\"></i>\n                  </div>\n                {/if}\n                <div class=\"p-5 flex-1 flex flex-col\">\n                  <h3 class=\"text-lg font-semibold text-gray-900 dark:text-white mb-1\">{group.name}</h3>\n                   <p class=\"text-sm text-gray-500 dark:text-gray-400 mb-3\">Topic: {group.topic}</p>\n                  <p class=\"text-sm text-gray-600 dark:text-gray-300 mb-4 line-clamp-2 flex-1\">{group.description}</p>\n                  <div class=\"flex justify-between items-center text-xs text-gray-500 dark:text-gray-400 mb-4\">\n                    <span><i class=\"fas fa-users mr-1\"></i> {group.memberCount} members</span>\n                    <span>{group.isPublic ? 'Public' : 'Private'}</span>\n                  </div>\n                  <div class=\"mt-auto\">\n                    {#if group.isPublic}\n                      <button \n                        on:click={() => handleJoin(group.id)}\n                        class=\"w-full px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-md text-sm font-medium transition-colors\"\n                      >\n                        <i class=\"fas fa-user-plus mr-2\"></i>\n                        Join Group\n                      </button>\n                    {:else}\n                      <button \n                        class=\"w-full px-4 py-2 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-md text-sm font-medium cursor-not-allowed\" disabled\n                      >\n                        <i class=\"fas fa-lock mr-2\"></i>\n                        Request to Join (Private)\n                      </button>\n                    {/if}\n                  </div>\n                </div>\n              </div>\n            {/each}\n          </div>\n        {/if}\n      </div>\n    </div>\n  {/if}\n</div>\n\n<style>\n  .loader {\n    border: 4px solid rgba(0, 0, 0, 0.1);\n    border-left-color: #4f46e5;\n    border-radius: 50%;\n    width: 40px;\n    height: 40px;\n    animation: spin 1s linear infinite;\n  }\n  \n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n\n  .line-clamp-2 {\n    display: -webkit-box;\n    -webkit-line-clamp: 2;\n    -webkit-box-orient: vertical;\n    overflow: hidden;\n  }\n</style>"],"names":["allGroups","$.mutable_source","searchQuery","selectedTopic","toggleGroupMembership","groupId","isMember","__async","groupIndex","g","$.mutate","$.set","e","loading","onMount","res","handleJoin","id","handleLeave","groupTopics","$.get","group","filteredGroups","matchesTopic","matchesSearch","myGroups","discoverGroups","$.each","select","topic","$.set_text","text","div_8","$.set_attribute","img","$$render","consequent_1","alternate_1","text_1","text_2","text_3","text_4","text_5","a","consequent_2","consequent_3","alternate_2","consequent_4","alternate_3","div_16","img_1","consequent_6","alternate_5","consequent_7","alternate_6","text_9","text_10","text_11","text_12","text_13","consequent_5","alternate_4","$.template_effect","text_6","$.bind_value","input","$$value","$.bind_select_value","$.transition","div_2","fade","consequent","alternate"],"mappings":"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"}