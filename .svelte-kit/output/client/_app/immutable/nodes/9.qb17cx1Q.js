var or=(K,Y,w)=>new Promise((z,G)=>{var v=l=>{try{u(w.next(l))}catch(f){G(f)}},m=l=>{try{u(w.throw(l))}catch(f){G(f)}},u=l=>l.done?z(l.value):Promise.resolve(l.value).then(v,m);u((w=w.apply(K,Y)).next())});import"../chunks/COm6N4YE.js";import"../chunks/69_IOA4Y.js";import{p as Br,b as Dr,s as t,m as g,d,n as S,r as a,c as i,g as r,t as T,k as Kr,e as Yr}from"../chunks/HPQed-Yx.js";import{s as F}from"../chunks/PqlH_gqs.js";import{i as M}from"../chunks/Da7F0fHf.js";import{e as mr,i as fr}from"../chunks/ErG-rR4v.js";import{t as h,a as _,r as zr,e as B}from"../chunks/ZM6Rlk1U.js";import{s as xr,r as D}from"../chunks/G1Z7eEzt.js";import{b as dr,a as _r}from"../chunks/D8Qc2aSm.js";import{b as Gr}from"../chunks/RqW7FABT.js";import{i as Hr}from"../chunks/D0cPXSkH.js";import{a as Jr,s as Nr}from"../chunks/CGqtlgv0.js";import{o as Or}from"../chunks/Bpt9IQqH.js";import{p as Qr}from"../chunks/BBukhNps.js";import{a as Rr,b as Ur,e as Vr}from"../chunks/BWnoWNEX.js";import{g as Wr}from"../chunks/GvWXBGfm.js";import{I as hr}from"../chunks/BC8mezXZ.js";var Xr=h('<div class="flex justify-center items-center py-12"><div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-cherry-500"></div></div>'),Zr=h('<div class="bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-400 p-4 rounded-md mb-6"><p> </p></div>'),Ir=h('<div class="bg-green-100 dark:bg-green-900/20 text-green-700 dark:text-green-400 p-4 rounded-md mb-6"><p> </p></div>'),re=h("<option> </option>"),ee=h('<div class="inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300"> <button type="button" class="ml-1.5 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"><!></button></div>'),te=h('<div class="flex flex-wrap gap-2 mt-2"></div>'),ae=h('<div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6"><!> <!> <div class="space-y-6"><div><label for="title" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Title *</label> <input type="text" id="title" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-cherry-500 focus:border-cherry-500 dark:focus:ring-cherry-400 dark:focus:border-cherry-400"></div> <div><label for="category" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Category *</label> <select id="category" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-cherry-500 focus:border-cherry-500 dark:focus:ring-cherry-400 dark:focus:border-cherry-400"><option disabled>Select a category</option><!></select></div> <div><label for="content" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Content *</label> <textarea id="content" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-cherry-500 focus:border-cherry-500 dark:focus:ring-cherry-400 dark:focus:border-cherry-400 min-h-[200px]"></textarea> <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">You can use Markdown formatting to structure your content.</p></div> <div><label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tags</label> <div class="flex"><input type="text" placeholder="Add tags (press Enter to add)" class="flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-l-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-cherry-500 focus:border-cherry-500 dark:focus:ring-cherry-400 dark:focus:border-cherry-400"> <button type="button" class="px-3 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 border-l-0 rounded-r-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">Add</button></div> <!></div> <div class="flex space-x-6"><div class="flex items-center"><input type="checkbox" id="is_pinned" class="h-4 w-4 text-cherry-600 dark:text-cherry-500 focus:ring-cherry-500 dark:focus:ring-cherry-400 border-gray-300 dark:border-gray-600 rounded"> <label for="is_pinned" class="ml-2 block text-sm text-gray-700 dark:text-gray-300">Pin this topic</label></div> <div class="flex items-center"><input type="checkbox" id="is_locked" class="h-4 w-4 text-cherry-600 dark:text-cherry-500 focus:ring-cherry-500 dark:focus:ring-cherry-400 border-gray-300 dark:border-gray-600 rounded"> <label for="is_locked" class="ml-2 block text-sm text-gray-700 dark:text-gray-300">Lock this topic (no new replies)</label></div></div> <div class="flex justify-end space-x-4"><a class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">Cancel</a> <button class="px-4 py-2 bg-cherry-600 text-white rounded-md hover:bg-cherry-700 dark:bg-cherry-500 dark:hover:bg-cherry-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"> </button></div></div></div>'),oe=h('<div class="container mx-auto px-4 py-8"><div class="max-w-3xl mx-auto"><div class="mb-6"><a class="inline-flex items-center text-cherry-600 dark:text-cherry-400 hover:underline mb-4"><!> Back to Topic</a> <h1 class="text-2xl font-bold text-gray-900 dark:text-white">Edit Forum Topic</h1></div> <!></div></div>');function we(K,Y){Br(Y,!1);const[w,z]=Nr(),v=Jr(Qr,"$page",w).params.id;let m=g(""),u=g(""),l=g(""),f=g(!1),P=g(!1),y=g([]),k=g(""),H=g([]),ir=g(!0),c=g(!1),x=g(null),A=g(null);Or(()=>or(null,null,function*(){try{const[o,b]=yield Promise.all([Rr(v),Ur()]);if(!o){t(x,"Topic not found");return}t(m,o.title),t(u,o.content||""),t(l,o.category_id),t(f,o.is_pinned||!1),t(P,o.is_locked||!1),t(y,o.tags||[]),t(H,b)}catch(o){console.error("Error loading topic data:",o),t(x,"Failed to load topic data. Please try again.")}finally{t(ir,!1)}}));function sr(){r(k).trim()&&!r(y).includes(r(k).trim())&&(t(y,[...r(y),r(k).trim()]),t(k,""))}function kr(o){t(y,r(y).filter(b=>b!==o))}function wr(o){o.key==="Enter"&&(o.preventDefault(),sr())}function Tr(){return or(this,null,function*(){if(!r(m).trim()||!r(u).trim()||!r(l)){t(x,"Title, content, and category are required");return}t(c,!0),t(x,null),t(A,null);try{(yield Vr(v,{title:r(m).trim(),content:r(u).trim(),category_id:r(l),is_pinned:r(f),is_locked:r(P),tags:r(y).length>0?r(y):void 0}))?(t(A,"Topic updated successfully!"),setTimeout(()=>{Wr(`/forums/topic/${v}`)},1500)):t(x,"Failed to update topic. Please try again.")}catch(o){console.error("Error updating topic:",o),t(x,"An error occurred while updating the topic.")}finally{t(c,!1)}})}Hr();var J=oe(),lr=d(J),N=d(lr),O=d(N);xr(O,"href",`/forums/topic/${v!=null?v:""}`);var $r=d(O);hr($r,{icon:"mdi:arrow-left",class:"w-5 h-5 mr-1"}),S(),a(O),S(2),a(N);var Cr=i(N,2);{var Er=o=>{var b=Xr();_(o,b)},Sr=o=>{var b=ae(),cr=d(b);{var Fr=e=>{var s=Zr(),n=d(s),p=d(n,!0);a(n),a(s),T(()=>F(p,r(x))),_(e,s)};M(cr,e=>{r(x)&&e(Fr)})}var nr=i(cr,2);{var Pr=e=>{var s=Ir(),n=d(s),p=d(n,!0);a(n),a(s),T(()=>F(p,r(A))),_(e,s)};M(nr,e=>{r(A)&&e(Pr)})}var gr=i(nr,2),Q=d(gr),R=i(d(Q),2);D(R),a(Q);var U=i(Q,2),L=i(d(U),2);T(()=>{r(l),Kr(()=>{r(c),r(H)})});var V=d(L);V.value=V.__value="";var Ar=i(V);mr(Ar,1,()=>r(H),fr,(e,s)=>{var n=re(),p={},C=d(n,!0);a(n),T(()=>{var E;p!==(p=r(s).id)&&(n.value=(E=n.__value=r(s).id)!=null?E:""),F(C,r(s).name)}),_(e,n)}),a(L),a(U);var W=i(U,2),X=i(d(W),2);zr(X),S(2),a(W);var Z=i(W,2),I=i(d(Z),2),$=d(I);D($);var vr=i($,2);a(I);var Lr=i(I,2);{var jr=e=>{var s=te();mr(s,5,()=>r(y),fr,(n,p)=>{var C=ee(),E=d(C),q=i(E),Mr=d(q);hr(Mr,{icon:"mdi:close",class:"w-4 h-4"}),a(q),a(C),T(()=>{var pr;F(E,`${(pr=r(p))!=null?pr:""} `),q.disabled=r(c)}),B("click",q,()=>kr(r(p))),_(n,C)}),a(s),_(e,s)};M(Lr,e=>{r(y).length>0&&e(jr)})}a(Z);var rr=i(Z,2),er=d(rr),tr=d(er);D(tr),S(2),a(er);var ur=i(er,2),ar=d(ur);D(ar),S(2),a(ur),a(rr);var yr=i(rr,2),br=d(yr);xr(br,"href",`/forums/topic/${v!=null?v:""}`);var j=i(br,2),qr=d(j,!0);a(j),a(yr),a(gr),a(b),T((e,s)=>{R.disabled=r(c),L.disabled=r(c),X.disabled=r(c),$.disabled=r(c),vr.disabled=e,tr.disabled=r(c),ar.disabled=r(c),j.disabled=s,F(qr,r(c)?"Saving...":"Save Changes")},[()=>r(c)||!r(k).trim(),()=>r(c)||!r(m).trim()||!r(u).trim()||!r(l)],Yr),dr(R,()=>r(m),e=>t(m,e)),Gr(L,()=>r(l),e=>t(l,e)),dr(X,()=>r(u),e=>t(u,e)),dr($,()=>r(k),e=>t(k,e)),B("keydown",$,wr),B("click",vr,sr),_r(tr,()=>r(f),e=>t(f,e)),_r(ar,()=>r(P),e=>t(P,e)),B("click",j,Tr),_(o,b)};M(Cr,o=>{r(ir)?o(Er):o(Sr,!1)})}a(lr),a(J),_(K,J),Dr(),z()}export{we as component};
//# sourceMappingURL=9.qb17cx1Q.js.map
