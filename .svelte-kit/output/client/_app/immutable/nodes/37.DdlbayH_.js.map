{"version":3,"file":"37.DdlbayH_.js","sources":["../../../../../../src/lib/components/StatCard.svelte","../../../../../../src/routes/statistics/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n  export let title: string;\n  export let value: string;\n  export let icon: string = 'fa-chart-line';\n  export let color: 'blue' | 'green' | 'red' | 'yellow' | 'indigo' | 'purple' | 'gray' = 'blue';\n\n  // Color style mapping types\n  type ColorStyle = {\n    bg: string;\n    text: string;\n  };\n\n  type ColorClasses = {\n    [key in typeof color]: ColorStyle;\n  };\n\n  // Map color names to Tailwind CSS classes\n  const colorClasses: ColorClasses = {\n    blue: {\n      bg: 'bg-blue-100 dark:bg-blue-900',\n      text: 'text-blue-600 dark:text-blue-300'\n    },\n    green: {\n      bg: 'bg-green-100 dark:bg-green-900',\n      text: 'text-green-600 dark:text-green-300'\n    },\n    red: {\n      bg: 'bg-red-100 dark:bg-red-900',\n      text: 'text-red-600 dark:text-red-300'\n    },\n    yellow: {\n      bg: 'bg-yellow-100 dark:bg-yellow-900',\n      text: 'text-yellow-600 dark:text-yellow-300'\n    },\n    indigo: {\n      bg: 'bg-indigo-100 dark:bg-indigo-900',\n      text: 'text-indigo-600 dark:text-indigo-300'\n    },\n    purple: {\n      bg: 'bg-purple-100 dark:bg-purple-900',\n      text: 'text-purple-600 dark:text-purple-300'\n    },\n    gray: {\n      bg: 'bg-gray-100 dark:bg-gray-800',\n      text: 'text-gray-600 dark:text-gray-300'\n    }\n  };\n\n  // Get color classes based on the color prop\n  $: colorStyle = colorClasses[color];\n</script>\n\n<div class=\"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow duration-300\">\n  <div class=\"flex items-center justify-between\">\n    <div>\n      <p class=\"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1\">{title}</p>\n      <p class=\"text-2xl font-bold text-gray-900 dark:text-white\">{value}</p>\n    </div>\n    <div class=\"h-12 w-12 {colorStyle.bg} rounded-full flex items-center justify-center {colorStyle.text}\">\n      <i class=\"fas {icon} text-xl\"></i>\n    </div>\n  </div>\n</div>","<script lang=\"ts\">\n  import { isAuthenticated, loading as authLoading } from '$lib/stores/authStore.js';\n  import { userProfile, userProfileLoading } from '$lib/stores/userProfileStore.js';\n  import { focusSessions, todos, exerciseSessions } from '$lib/stores/pipStores';\n  import { goto } from '$app/navigation';\n  import StatCard from '$lib/components/StatCard.svelte';\n  import FocusTimeChart from '$lib/components/FocusTimeChart.svelte';\n  import type { UserPreferences } from '$lib/services/userService';\n\n  // Chart unit\n  let unit: 'day' | 'week' | 'month' = 'week';\n\n  // Derived stats\n  let totalFocus = 0;\n  let sessionCount = 0;\n  let avgSession = 0;\n  let longestSession = 0;\n  let tasksDone = 0;\n  let exercisesCompleted = 0;\n  let enrollmentsCount = 0;\n\n  function goToLogin() {\n    goto('/login?redirect=/statistics');\n  }\n\n  // Recompute stats whenever relevant stores update\n  $: if ($isAuthenticated && !$authLoading && !$userProfileLoading && $userProfile) {\n    const sessions = $focusSessions;\n    sessionCount = sessions.length;\n    totalFocus = sessions.reduce((sum, s) => sum + s.duration / 60, 0);\n    avgSession = sessionCount ? totalFocus / sessionCount : 0;\n    longestSession = sessions.reduce((max, s) => Math.max(max, s.duration / 60), 0);\n    tasksDone = $todos.filter(t => t.completed).length;\n    exercisesCompleted = $exerciseSessions.filter(es => es.completed).length;\n    \n    // Safe access to preferences with proper type checking\n    const preferences: UserPreferences = $userProfile.preferences || {};\n    const enrollments = preferences.enrollments || [];\n    enrollmentsCount = enrollments.filter(e => e.progress > 0 && e.progress < 100).length;\n  }\n</script>\n\n<svelte:head>\n  <title>Statistics | LearnFlow</title>\n</svelte:head>\n\n{#if $authLoading}\n  <div class=\"flex items-center justify-center min-h-[60vh]\"><i class=\"fas fa-spinner fa-spin text-4xl text-indigo-500\"></i></div>\n{:else if !$isAuthenticated}\n  <div class=\"flex flex-col items-center justify-center min-h-[60vh]\">\n    <p class=\"text-lg text-gray-600 dark:text-gray-300 mb-4\">Log in to view your statistics.</p>\n    <button class=\"px-6 py-2 bg-indigo-600 text-white rounded\" on:click={goToLogin}>Log In</button>\n  </div>\n{:else if $userProfileLoading}\n  <div class=\"flex items-center justify-center min-h-[60vh]\"><i class=\"fas fa-spinner fa-spin text-4xl text-indigo-500\"></i></div>\n{:else}\n  <div class=\"max-w-5xl mx-auto px-4 py-6 space-y-8\">\n    <h1 class=\"text-3xl font-bold text-gray-900 dark:text-white\">Your Statistics</h1>\n    <div class=\"grid grid-cols-2 md:grid-cols-4 gap-6\">\n      <StatCard title=\"Focus Sessions\" value={String(sessionCount)} icon=\"fa-stopwatch\" color=\"yellow\" />\n      <StatCard title=\"Total Focus (min)\" value={String(Math.round(totalFocus))} icon=\"fa-clock\" color=\"purple\" />\n      <StatCard title=\"Avg Session (min)\" value={avgSession.toFixed(1)} icon=\"fa-chart-line\" color=\"blue\" />\n      <StatCard title=\"Longest Session\" value={longestSession.toFixed(1)} icon=\"fa-mountain\" color=\"indigo\" />\n      <StatCard title=\"Tasks Completed\" value={String(tasksDone)} icon=\"fa-list-check\" color=\"green\" />\n      <StatCard title=\"Exercises Completed\" value={String(exercisesCompleted)} icon=\"fa-pencil-alt\" color=\"gray\" />\n      <StatCard title=\"Courses In Progress\" value={String(enrollmentsCount)} icon=\"fa-book-open\" color=\"red\" />\n    </div>\n    <div class=\"space-y-4\">\n      <div class=\"flex items-center space-x-4\">\n        <label class=\"font-medium\">View by:</label>\n        <select bind:value={unit} class=\"rounded border-gray-300 p-2 bg-white dark:bg-gray-800\">\n          <option value=\"day\">Daily</option>\n          <option value=\"week\">Weekly</option>\n          <option value=\"month\">Monthly</option>\n        </select>\n      </div>\n      <div class=\"bg-white dark:bg-gray-800 rounded-lg shadow p-4\" style=\"height: 300px;\">\n        <FocusTimeChart sessions={$focusSessions} timeUnit={unit} />\n      </div>\n    </div>\n  </div>\n{/if}"],"names":["title","$.prop","$$props","value","icon","color","colorClasses","colorStyle","$.set_class","div_3","$.get","_c","unit","totalFocus","sessionCount","avgSession","longestSession","tasksDone","exercisesCompleted","enrollmentsCount","goToLogin","goto","$isAuthenticated","$authLoading","$userProfileLoading","$userProfile","sessions","$focusSessions","$.set","sum","s","max","$todos","t","$exerciseSessions","es","enrollments","e","expression","$.derived_safe_equal","expression_1","expression_4","expression_5","expression_6","$.bind_select_value","select","$$value","$$render","consequent_2","alternate_2","alternate_1","consequent_1","consequent","alternate"],"mappings":"qtCACaA,EAAaC,EAAAC,EAAA,QAAA,CAAA,EACbC,EAAaF,EAAAC,EAAA,QAAA,CAAA,EACbE,eAAe,eAAe,EAC9BC,gBAA4E,MAAM,QAavFC,EAA0B,CAC9B,KAAI,CACF,GAAI,+BACJ,KAAM,oCAER,MAAK,CACH,GAAI,iCACJ,KAAM,sCAER,IAAG,CACD,GAAI,6BACJ,KAAM,kCAER,OAAM,CACJ,GAAI,mCACJ,KAAM,wCAER,OAAM,CACJ,GAAI,mCACJ,KAAM,wCAER,OAAM,CACJ,GAAI,mCACJ,KAAM,wCAER,KAAI,CACF,GAAI,+BACJ,KAAM,2DAKPC,EAAaD,EAAaD,EAAK,CAAA,CAAA,mJAMwCL,GAAK,OACdG,GAAK,EAE7CK,GAAAC,EAAA,EAAA,cAAAC,EAAAA,EAAAH,CAAU,EAAC,KAAXG,KAAAA,EAA8D,EAAA,mDAAAA,EAAAA,EAAAH,CAAU,EAAC,OAAXG,KAAAA,EAAe,EAAA,EAAA,iBACnFC,EAAAP,MAAA,KAAAO,EAAI,EAAA,UAAA,o3CCjDnB,IAAAC,IAAiC,MAAM,EAGvCC,IAAa,CAAC,EACdC,IAAe,CAAC,EAChBC,IAAa,CAAC,EACdC,IAAiB,CAAC,EAClBC,IAAY,CAAC,EACbC,IAAqB,CAAC,EACtBC,IAAmB,CAAC,EAEf,SAAAC,GAAY,CACnBC,GAAK,6BAA6B,CACpC,qDAGO,GAAAC,MAAqBC,EAAY,GAAA,CAAKC,EAAmB,GAAIC,IAAc,CAC1E,MAAAC,EAAWC,EAAc,IAC/Bb,EAAeY,EAAS,MAAM,EAC9BE,EAAAf,EAAaa,EAAS,OAAM,CAAEG,EAAKC,IAAMD,EAAMC,EAAE,SAAW,GAAI,CAAC,CAAA,EACjEF,EAAAb,IAAaD,CAAY,EAAAJ,EAAGG,CAAU,EAAGH,EAAAI,CAAY,EAAG,CAAC,IACzDE,EAAiBU,EAAS,QAAQK,EAAKD,IAAM,KAAK,IAAIC,EAAKD,EAAE,SAAW,EAAE,EAAG,CAAC,CAAA,IAC9Eb,EAAYe,EAAM,EAAC,OAAOC,GAAKA,EAAE,SAAS,EAAE,MAAM,IAClDf,EAAqBgB,EAAiB,EAAC,OAAOC,GAAMA,EAAG,SAAS,EAAE,MAAM,QAIlEC,GAD+BX,IAAa,aAAW,CAAA,GAC7B,aAAW,CAAA,EAC3CG,EAAAT,EAAmBiB,EAAY,OAAOC,GAAKA,EAAE,SAAW,GAAKA,EAAE,SAAW,GAAG,EAAE,MAAM,CACvF,+KAYuEjB,CAAS,uFAQpC,MAAAkB,GAAAC,EAAA,IAAA,SAAOzB,CAAY,CAAA,CAAA,0GAChB,MAAA0B,GAAAD,EAAA,IAAA,OAAO,KAAK,QAAM1B,CAAU,CAAA,CAAA,CAAA,0HAC5BE,CAAU,EAAC,QAAQ,CAAC,CAAA,6HACtBC,CAAc,EAAC,QAAQ,CAAC,CAAA,0GACxB,MAAAyB,GAAAF,EAAA,IAAA,SAAOtB,CAAS,CAAA,CAAA,2GACZ,MAAAyB,GAAAH,EAAA,IAAA,SAAOrB,CAAkB,CAAA,CAAA,+GACzB,MAAAyB,GAAAJ,EAAA,IAAA,SAAOpB,CAAgB,CAAA,CAAA,iJAK9CP,CAAI,4LAOEe,EAAc,2BAAYf,CAAI,sBAPpCgC,GAAAC,EAAA,IAAAnC,EAAAE,CAAI,QAAJA,EAAIkC,EAAA,CAAA,kBAjBtBtB,EAAmB,EAAAuB,EAAAC,CAAA,EAAAD,EAAAE,GAAA,EAAA,gBALlB3B,EAAgB,EAAAyB,EAAAG,EAAA,EAAA,EAAAH,EAAAI,CAAA,iBAFtB5B,EAAY,EAAAwB,EAAAK,EAAA,EAAAL,EAAAM,GAAA,EAAA"}