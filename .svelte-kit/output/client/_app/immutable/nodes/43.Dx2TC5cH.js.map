{"version":3,"file":"43.Dx2TC5cH.js","sources":["../../../../../../src/lib/utils/markdown.js","../../../../../../src/lib/components/MarkdownRendererComponent.svelte","../../../../../../src/routes/tools/notepad/+page.svelte"],"sourcesContent":["/**\n * Utility functions for working with markdown\n */\n\n// Simple markdown renderer that doesn't require external libraries\nexport function renderMarkdown(markdown) {\n  // This is a very basic markdown renderer\n  // For a real app, you'd want to use a proper library\n  if (!markdown) return '';\n  \n  return markdown\n    // Handle headings\n    .replace(/^### (.*$)/gim, '<h3>$1</h3>')\n    .replace(/^## (.*$)/gim, '<h2>$1</h2>')\n    .replace(/^# (.*$)/gim, '<h1>$1</h1>')\n    // Handle code blocks\n    .replace(/```(\\w*)\\n([\\s\\S]*?)```/gm, '<pre><code class=\"language-$1\">$2</code></pre>')\n    // Handle inline code\n    .replace(/`([^`]+)`/g, '<code>$1</code>')\n    // Handle bold\n    .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n    // Handle emphasis\n    .replace(/\\*(.*?)\\*/g, '<em>$1</em>')\n    // Handle links\n    .replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"$2\">$1</a>')\n    // Handle paragraphs\n    .replace(/^\\s*(\\n)?(.+)/gm, function(m) {\n      return /^<(\\/)?(h\\d|pre|ul|ol|li|blockquote|p|table|tr|td|th)/.test(m) ? m : '<p>' + m + '</p>';\n    })\n    // Handle line breaks\n    .replace(/\\n/g, '<br>');\n}\n\n// Function to load external markdown renderer from CDN\nexport function loadMarkedLibrary() {\n  return new Promise((resolve) => {\n    // If already loaded, resolve immediately\n    if (typeof window !== 'undefined' && window.marked) {\n      resolve(window.marked);\n      return;\n    }\n    \n    // Otherwise load from CDN\n    const script = document.createElement('script');\n    script.src = 'https://cdn.jsdelivr.net/npm/marked@4.3.0/marked.min.js';\n    script.onload = () => resolve(window.marked);\n    document.head.appendChild(script);\n  });\n}\n","<script lang=\"ts\">\n  import { onMount, afterUpdate } from 'svelte';\n  import DOMPurify from 'dompurify';\n  import hljs from 'highlight.js';\n  import 'highlight.js/styles/github-dark.css';\n  import { browser } from '$app/environment';\n  import { renderMarkdown } from '$lib/utils/markdown';\n\n  export let content: string = '';\n  \n  let htmlContent: string = '';\n  let markdownContainer: HTMLDivElement;\n  \n  // Process content into HTML with sanitization\n  function updateContent() {\n    if (!content) {\n      htmlContent = '';\n      return;\n    }\n    \n    try {\n      // Use our updated renderMarkdown function that uses markdown-it\n      htmlContent = renderMarkdown(content);\n      \n      // Additional client-side sanitization for SSR content\n      if (browser && DOMPurify && typeof htmlContent === 'string') {\n        htmlContent = DOMPurify.sanitize(htmlContent, {\n          USE_PROFILES: { html: true },\n          ADD_ATTR: ['target', 'rel'],\n          ADD_TAGS: ['math', 'mrow', 'mi', 'mo', 'mn', 'msup', 'sub', 'sup']\n        });\n      }\n    } catch (error) {\n      console.error('Error rendering markdown:', error);\n      htmlContent = `<p>Error rendering content</p>`;\n    }\n  }\n  \n  // Watch content for changes and rerender\n  $: if (content) {\n    updateContent();\n  }\n  \n  onMount(() => {\n    updateContent();\n    \n    if (browser && markdownContainer) {\n      applyHighlighting();\n    }\n  });\n  \n  afterUpdate(() => {\n    if (browser && markdownContainer) {\n      applyHighlighting();\n    }\n  });\n  \n  // Apply syntax highlighting to code blocks\n  function applyHighlighting() {\n    if (!markdownContainer) return;\n    \n    const codeBlocks = markdownContainer.querySelectorAll('pre code:not(.hljs)');\n    codeBlocks.forEach((block) => {\n      hljs.highlightElement(block as HTMLElement);\n    });\n  }\n</script>\n\n<div class=\"markdown-content\" bind:this={markdownContainer}>\n  {#if browser || htmlContent}\n    {@html htmlContent}\n  {:else}\n    <div class=\"loading\">Loading content...</div>\n  {/if}\n</div>\n\n<style>\n  .loading {\n    padding: 1rem;\n    color: #6b7280;\n    font-style: italic;\n  }\n\n  .markdown-content :global(pre) {\n    padding: 1rem;\n    border-radius: 0.5rem;\n    margin: 1rem 0;\n    overflow-x: auto;\n  }\n  \n  .markdown-content :global(code) {\n    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace;\n  }\n  \n  .markdown-content :global(p) {\n    margin-bottom: 1rem;\n  }\n  \n  .markdown-content :global(h1),\n  .markdown-content :global(h2),\n  .markdown-content :global(h3),\n  .markdown-content :global(h4),\n  .markdown-content :global(h5) {\n    margin-top: 1.5rem;\n    margin-bottom: 0.75rem;\n    font-weight: 600;\n  }\n  \n  .markdown-content :global(ul),\n  .markdown-content :global(ol) {\n    margin-left: 1.5rem;\n    margin-bottom: 1rem;\n  }\n  \n  .markdown-content :global(blockquote) {\n    border-left: 4px solid #e5e7eb;\n    padding-left: 1rem;\n    color: #6b7280;\n    margin: 1rem 0;\n  }\n  \n  .markdown-content :global(a) {\n    color: #3b82f6;\n    text-decoration: underline;\n  }\n  \n  .markdown-content :global(table) {\n    border-collapse: collapse;\n    width: 100%;\n    margin: 1rem 0;\n  }\n  \n  .markdown-content :global(th), \n  .markdown-content :global(td) {\n    border: 1px solid #e5e7eb;\n    padding: 0.5rem;\n  }\n  \n  .markdown-content :global(th) {\n    background-color: #f3f4f6;\n  }\n  \n  /* Custom styles for markdown-it containers */\n  .markdown-content :global(.info),\n  .markdown-content :global(.warning),\n  .markdown-content :global(.danger) {\n    padding: 1em;\n    margin-bottom: 1em;\n    border-radius: 0.375rem;\n  }\n  \n  .markdown-content :global(.info) {\n    background-color: #eff6ff;\n    border-left: 4px solid #3b82f6;\n  }\n  \n  .markdown-content :global(.warning) {\n    background-color: #fffbeb;\n    border-left: 4px solid #f59e0b;\n  }\n  \n  .markdown-content :global(.danger) {\n    background-color: #fee2e2;\n    border-left: 4px solid #ef4444;\n  }\n  \n  /* KaTeX math rendering styles */\n  .markdown-content :global(.katex-display) {\n    overflow-x: auto;\n    overflow-y: hidden;\n    padding: 0.5em 0;\n  }\n</style>","<script lang=\"ts\">\n  import { onMount, onDestroy } from 'svelte';\n  import { notepadContent } from '$lib/stores/pipStores';\n  import MarkdownRenderer from '$lib/components/MarkdownRendererComponent.svelte';\n  import { logStart, logEnd } from '$lib/services/activityService';\n\n  // Bind directly to the persistent store\n  let note = '';\n  const unsubscribe = notepadContent.subscribe(value => note = value);\n\n  let saved = false;\n  let showSaveAnim = false;\n  let notepadViewId: string | null = null;\n  let showPreview = true;\n\n  onMount(async () => {\n    notepadViewId = await logStart('view_notepad', 'notepad');\n  });\n\n  onDestroy(() => {\n    if (notepadViewId) logEnd(notepadViewId);\n    unsubscribe();\n  });\n\n  function saveNote() {\n    notepadContent.set(note);\n    saved = true;\n    showSaveAnim = true;\n    setTimeout(() => showSaveAnim = false, 1200);\n    setTimeout(() => saved = false, 2000);\n  }\n\n  function clearNote() {\n    note = '';\n    notepadContent.set('');\n  }\n\n  function handleInput() {\n    saved = false;\n  }\n\n  function togglePreview() {\n    showPreview = !showPreview;\n  }\n</script>\n\n<svelte:head>\n  <title>Notepad | LearnFlow</title>\n</svelte:head>\n\n<div class=\"max-w-4xl mx-auto px-4 py-10\">\n  <h1 class=\"text-3xl font-bold text-gray-900 dark:text-white mb-4 flex items-center\">\n    <i class=\"fas fa-sticky-note mr-3 text-yellow-400\"></i> Notepad\n  </h1>\n  <p class=\"text-gray-600 dark:text-gray-300 mb-6\">Jot down notes, ideas, or summaries. Supports <span class=\"font-semibold\">Markdown</span> with live preview!</p>\n\n  <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n    <div class=\"flex flex-col\">\n      <label class=\"mb-2 text-sm font-medium text-gray-700 dark:text-gray-200\" for=\"notepad\">Your Notes</label>\n      <textarea\n        id=\"notepad\"\n        class=\"w-full h-64 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white p-4 font-mono text-base shadow focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-vertical transition\"\n        bind:value={note}\n        on:input={handleInput}\n        placeholder=\"Write your notes here...\"\n      ></textarea>\n      <div class=\"flex space-x-2 mt-4\">\n        <button class=\"px-4 py-2 bg-indigo-600 text-white rounded-md font-semibold shadow hover:bg-indigo-700 transition\" on:click={saveNote}>\n          <i class=\"fas fa-save mr-2\"></i> Save\n        </button>\n        <button class=\"px-4 py-2 bg-gray-200 text-gray-700 rounded-md font-semibold shadow hover:bg-gray-300 transition\" on:click={clearNote}>\n          <i class=\"fas fa-eraser mr-2\"></i> Clear\n        </button>\n        <button class=\"px-4 py-2 bg-gray-200 text-gray-700 rounded-md font-semibold shadow hover:bg-gray-300 transition\" on:click={togglePreview}>\n          Toggle Preview\n        </button>\n        {#if showSaveAnim}\n          <span class=\"ml-2 animate-bounce text-green-500 text-xl\">✔️</span>\n        {/if}\n        {#if saved && !showSaveAnim}\n          <span class=\"ml-2 text-green-500 text-sm\">Saved!</span>\n        {/if}\n      </div>\n    </div>\n    {#if showPreview}\n      <div>\n        <label class=\"mb-2 text-sm font-medium text-gray-700 dark:text-gray-200 block\">Live Preview</label>\n        <div class=\"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg p-4 h-64 overflow-auto shadow-inner prose dark:prose-invert\">\n          <MarkdownRenderer content={note} />\n        </div>\n      </div>\n    {/if}\n  </div>\n</div>\n\n<style>\n  .animate-bounce {\n    animation: bounce 0.7s infinite alternate;\n  }\n  @keyframes bounce {\n    0% { transform: translateY(0); }\n    100% { transform: translateY(-10px); }\n  }\n</style>\n"],"names":["renderMarkdown","markdown","m","content","htmlContent","markdownContainer","$.mutable_source","updateContent","$.set","browser","DOMPurify","$.get","error","onMount","applyHighlighting","afterUpdate","block","hljs","$$render","consequent","$.bind_this","div","$$value","note","unsubscribe","notepadContent","value","saved","showSaveAnim","notepadViewId","showPreview","__async","logStart","onDestroy","logEnd","saveNote","clearNote","handleInput","togglePreview","consequent_1","consequent_2","$.bind_value","textarea"],"mappings":"6+BAKO,SAASA,GAAeC,EAAU,CAGvC,OAAKA,EAEEA,EAEJ,QAAQ,gBAAiB,aAAa,EACtC,QAAQ,eAAgB,aAAa,EACrC,QAAQ,cAAe,aAAa,EAEpC,QAAQ,4BAA6B,gDAAgD,EAErF,QAAQ,aAAc,iBAAiB,EAEvC,QAAQ,iBAAkB,qBAAqB,EAE/C,QAAQ,aAAc,aAAa,EAEnC,QAAQ,2BAA4B,qBAAqB,EAEzD,QAAQ,kBAAmB,SAASC,EAAG,CACtC,MAAO,wDAAwD,KAAKA,CAAC,EAAIA,EAAI,MAAQA,EAAI,MAC1F,CAAA,EAEA,QAAQ,MAAO,MAAM,EAtBF,EAuBxB,6FCvBa,IAAAC,mBAAkB,EAAE,EAE3BC,IAAsB,EAAE,EACxBC,EAAiCC,EAAA,EAG5B,SAAAC,GAAgB,CAClB,GAAA,CAAAJ,EAAO,EAAE,CACZK,EAAAJ,EAAc,EAAE,QAElB,CAEI,GAAA,GAEFA,EAAcJ,GAAeG,EAAO,CAAA,CAAA,EAGhCM,IAAWC,GAAS,OAAAC,EAAWP,CAAW,GAAK,UACjDI,EAAAJ,EAAcM,EAAU,WAASN,CAAW,EAAA,CAC1C,aAAY,CAAI,KAAM,EAAI,EAC1B,SAAQ,CAAG,SAAU,KAAK,EAC1B,SAAQ,CAAG,OAAQ,OAAQ,KAAM,KAAM,KAAM,OAAQ,MAAO,SAGjE,OAAQQ,EAAO,CACd,QAAQ,MAAM,4BAA6BA,CAAK,IAChDR,EAAW,gCAAA,CACb,CACF,CAOAS,EAAc,IAAA,CACZN,EAAa,EAEFI,EAAIN,CAAiB,GAC9BS,EAAiB,EAEpB,EAEDC,GAAkB,IAAA,CACLJ,EAAIN,CAAiB,GAC9BS,EAAiB,EAEpB,EAGQ,SAAAA,GAAoB,OACtBT,CAAiB,EAAA,OAEHM,EAAAN,CAAiB,EAAC,iBAAiB,qBAAqB,EAChE,QAASW,GAAU,CAC5BC,GAAK,iBAAiBD,CAAK,EAC5B,CACH,mBA1BOb,EAAO,GACZI,EAAa,qEA8BNH,CAAW,CAAA,kBADOc,EAAAC,CAAA,SADYC,GAAAC,EAAAC,GAAAd,EAAAH,WAAAA,CAAiB,CAAA,6nEC7DpD,IAAAkB,IAAO,EAAE,QACPC,EAAcC,EAAe,UAAUC,GAAKlB,EAAIe,EAAOG,CAAK,CAAA,EAE9D,IAAAC,IAAQ,EAAK,EACbC,IAAe,EAAK,EACpBC,EAA+B,KAC/BC,IAAc,EAAI,EAEtBjB,EAAoB,IAAAkB,EAAA,sBAClBF,EAAsB,MAAAG,GAAS,eAAgB,SAAS,GACzD,EAEDC,GAAgB,IAAA,CACVJ,GAAeK,GAAOL,CAAa,EACvCL,EAAW,EACZ,EAEQ,SAAAW,GAAW,CAClBV,EAAe,IAAGd,EAACY,CAAI,CAAA,EACvBf,EAAAmB,EAAQ,EAAI,EACZnB,EAAAoB,EAAe,EAAI,EACnB,WAAiB,IAAApB,EAAAoB,EAAe,EAAK,EAAE,IAAI,EAC3C,WAAiB,IAAApB,EAAAmB,EAAQ,EAAK,EAAE,GAAI,CACtC,CAES,SAAAS,GAAY,CACnB5B,EAAAe,EAAO,EAAE,EACTE,EAAe,IAAI,EAAE,CACvB,CAES,SAAAY,GAAc,CACrB7B,EAAAmB,EAAQ,EAAK,CACf,CAES,SAAAW,GAAgB,CACvB9B,EAAAsB,KAAeA,CAAW,CAAA,CAC5B,sLAiCWF,CAAY,GAAAV,EAAAC,CAAA,uDAGZR,EAAAgB,CAAK,MAAKC,CAAY,GAAAV,EAAAqB,CAAA,iGASEhB,CAAI,iCAJhCO,CAAW,GAAAZ,EAAAsB,CAAA,cAtBAC,GAAAC,EAAA,IAAA/B,EAAAY,CAAI,OAAJA,EAAID,CAAA,CAAA,cACNe,CAAW,cAIuGF,CAAQ,cAGTC,CAAS,cAGTE,CAAa"}