{"version":3,"file":"9.qb17cx1Q.js","sources":["../../../../../../src/routes/admin/forums/topic/[id]/edit/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n  import { onMount } from 'svelte';\n  import { page } from '$app/stores';\n  import { getForumTopic, updateTopic, getCategories } from '$lib/services/forums/forumService';\n  import type { ForumCategory, ForumTopic } from '$lib/types/forumTypes';\n  import { goto } from '$app/navigation';\n  import Icon from '@iconify/svelte';\n  \n  const topicId = $page.params.id;\n  \n  let title = '';\n  let content = '';\n  let category_id = '';\n  let is_pinned = false;\n  let is_locked = false;\n  let tags: string[] = [];\n  let newTag = '';\n  let categories: ForumCategory[] = [];\n  \n  let isLoading = true;\n  let isSaving = false;\n  let error: string | null = null;\n  let success: string | null = null;\n  \n  onMount(async () => {\n    try {\n      const [topic, categoriesList] = await Promise.all([\n        getForumTopic(topicId),\n        getCategories()\n      ]);\n      \n      if (!topic) {\n        error = 'Topic not found';\n        return;\n      }\n      \n      title = topic.title;\n      content = topic.content || '';\n      category_id = topic.category_id;\n      is_pinned = topic.is_pinned || false;\n      is_locked = topic.is_locked || false;\n      tags = topic.tags || [];\n      categories = categoriesList;\n    } catch (err) {\n      console.error('Error loading topic data:', err);\n      error = 'Failed to load topic data. Please try again.';\n    } finally {\n      isLoading = false;\n    }\n  });\n  \n  function addTag() {\n    if (newTag.trim() && !tags.includes(newTag.trim())) {\n      tags = [...tags, newTag.trim()];\n      newTag = '';\n    }\n  }\n  \n  function removeTag(tag: string) {\n    tags = tags.filter(t => t !== tag);\n  }\n  \n  function handleKeydown(event: KeyboardEvent) {\n    if (event.key === 'Enter') {\n      event.preventDefault();\n      addTag();\n    }\n  }\n  \n  async function handleSubmit() {\n    if (!title.trim() || !content.trim() || !category_id) {\n      error = 'Title, content, and category are required';\n      return;\n    }\n    \n    isSaving = true;\n    error = null;\n    success = null;\n    \n    try {\n      const result = await updateTopic(topicId, {\n        title: title.trim(),\n        content: content.trim(),\n        category_id,\n        is_pinned,\n        is_locked,\n        tags: tags.length > 0 ? tags : undefined\n      });\n      \n      if (result) {\n        success = 'Topic updated successfully!';\n        setTimeout(() => {\n          goto(`/forums/topic/${topicId}`);\n        }, 1500);\n      } else {\n        error = 'Failed to update topic. Please try again.';\n      }\n    } catch (err) {\n      console.error('Error updating topic:', err);\n      error = 'An error occurred while updating the topic.';\n    } finally {\n      isSaving = false;\n    }\n  }\n</script>\n\n<!-- Placeholder for admin topic edit page -->\n\n<div class=\"container mx-auto px-4 py-8\">\n  <div class=\"max-w-3xl mx-auto\">\n    <div class=\"mb-6\">\n      <a href=\"/forums/topic/{topicId}\" class=\"inline-flex items-center text-cherry-600 dark:text-cherry-400 hover:underline mb-4\">\n        <Icon icon=\"mdi:arrow-left\" class=\"w-5 h-5 mr-1\" />\n        Back to Topic\n      </a>\n      \n      <h1 class=\"text-2xl font-bold text-gray-900 dark:text-white\">Edit Forum Topic</h1>\n    </div>\n    \n    {#if isLoading}\n      <div class=\"flex justify-center items-center py-12\">\n        <div class=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-cherry-500\"></div>\n      </div>\n    {:else}\n      <div class=\"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6\">\n        {#if error}\n          <div class=\"bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-400 p-4 rounded-md mb-6\">\n            <p>{error}</p>\n          </div>\n        {/if}\n        \n        {#if success}\n          <div class=\"bg-green-100 dark:bg-green-900/20 text-green-700 dark:text-green-400 p-4 rounded-md mb-6\">\n            <p>{success}</p>\n          </div>\n        {/if}\n        \n        <div class=\"space-y-6\">\n          <div>\n            <label for=\"title\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              Title *\n            </label>\n            <input\n              type=\"text\"\n              id=\"title\"\n              bind:value={title}\n              class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-cherry-500 focus:border-cherry-500 dark:focus:ring-cherry-400 dark:focus:border-cherry-400\"\n              disabled={isSaving}\n            />\n          </div>\n          \n          <div>\n            <label for=\"category\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              Category *\n            </label>\n            <select\n              id=\"category\"\n              bind:value={category_id}\n              class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-cherry-500 focus:border-cherry-500 dark:focus:ring-cherry-400 dark:focus:border-cherry-400\"\n              disabled={isSaving}\n            >\n              <option value=\"\" disabled>Select a category</option>\n              {#each categories as category}\n                <option value={category.id}>{category.name}</option>\n              {/each}\n            </select>\n          </div>\n          \n          <div>\n            <label for=\"content\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              Content *\n            </label>\n            <textarea\n              id=\"content\"\n              bind:value={content}\n              class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-cherry-500 focus:border-cherry-500 dark:focus:ring-cherry-400 dark:focus:border-cherry-400 min-h-[200px]\"\n              disabled={isSaving}\n            ></textarea>\n            <p class=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n              You can use Markdown formatting to structure your content.\n            </p>\n          </div>\n          \n          <div>\n            <label class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              Tags\n            </label>\n            <div class=\"flex\">\n              <input\n                type=\"text\"\n                bind:value={newTag}\n                on:keydown={handleKeydown}\n                placeholder=\"Add tags (press Enter to add)\"\n                class=\"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-l-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-cherry-500 focus:border-cherry-500 dark:focus:ring-cherry-400 dark:focus:border-cherry-400\"\n                disabled={isSaving}\n              />\n              <button\n                on:click={addTag}\n                type=\"button\"\n                class=\"px-3 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 border-l-0 rounded-r-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors\"\n                disabled={isSaving || !newTag.trim()}\n              >\n                Add\n              </button>\n            </div>\n            \n            {#if tags.length > 0}\n              <div class=\"flex flex-wrap gap-2 mt-2\">\n                {#each tags as tag}\n                  <div class=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300\">\n                    {tag}\n                    <button\n                      on:click={() => removeTag(tag)}\n                      type=\"button\"\n                      class=\"ml-1.5 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200\"\n                      disabled={isSaving}\n                    >\n                      <Icon icon=\"mdi:close\" class=\"w-4 h-4\" />\n                    </button>\n                  </div>\n                {/each}\n              </div>\n            {/if}\n          </div>\n          \n          <div class=\"flex space-x-6\">\n            <div class=\"flex items-center\">\n              <input\n                type=\"checkbox\"\n                id=\"is_pinned\"\n                bind:checked={is_pinned}\n                class=\"h-4 w-4 text-cherry-600 dark:text-cherry-500 focus:ring-cherry-500 dark:focus:ring-cherry-400 border-gray-300 dark:border-gray-600 rounded\"\n                disabled={isSaving}\n              />\n              <label for=\"is_pinned\" class=\"ml-2 block text-sm text-gray-700 dark:text-gray-300\">\n                Pin this topic\n              </label>\n            </div>\n            \n            <div class=\"flex items-center\">\n              <input\n                type=\"checkbox\"\n                id=\"is_locked\"\n                bind:checked={is_locked}\n                class=\"h-4 w-4 text-cherry-600 dark:text-cherry-500 focus:ring-cherry-500 dark:focus:ring-cherry-400 border-gray-300 dark:border-gray-600 rounded\"\n                disabled={isSaving}\n              />\n              <label for=\"is_locked\" class=\"ml-2 block text-sm text-gray-700 dark:text-gray-300\">\n                Lock this topic (no new replies)\n              </label>\n            </div>\n          </div>\n          \n          <div class=\"flex justify-end space-x-4\">\n            <a \n              href=\"/forums/topic/{topicId}\" \n              class=\"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors\"\n            >\n              Cancel\n            </a>\n            \n            <button \n              on:click={handleSubmit}\n              disabled={isSaving || !title.trim() || !content.trim() || !category_id}\n              class=\"px-4 py-2 bg-cherry-600 text-white rounded-md hover:bg-cherry-700 dark:bg-cherry-500 dark:hover:bg-cherry-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n            >\n              {isSaving ? 'Saving...' : 'Save Changes'}\n            </button>\n          </div>\n        </div>\n      </div>\n    {/if}\n  </div>\n</div>"],"names":["topicId","title","content","category_id","is_pinned","is_locked","tags","$.mutable_source","newTag","categories","isLoading","isSaving","error","success","onMount","__async","topic","categoriesList","getForumTopic","getCategories","$.set","err","addTag","$.get","removeTag","tag","t","handleKeydown","event","handleSubmit","updateTopic","goto","$$render","consequent_1","consequent_2","$.each","node_4","category","option_1_value","option_1","_a","$.set_text","text_2","div_13","$.event","button_1","consequent_3","$.bind_value","input","$$value","$.bind_select_value","select","textarea","input_1","$.bind_checked","input_2","input_3","consequent","alternate"],"mappings":"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"}