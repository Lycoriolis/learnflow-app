{"version":3,"file":"26.Com1b8Bj.js","sources":["../../../../../../src/lib/components/forums/ForumTopic.svelte","../../../../../../src/routes/forums/topic/[id]/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n  import { onMount } from 'svelte';\n  import { currentTopic, posts, loadTopic, isLoading, error } from '$lib/stores/forumStore';\n  import Icon from '@iconify/svelte';\n  import MarkdownRenderer from '$lib/components/shared/MarkdownRenderer.svelte';\n  import type { ForumPost } from '$lib/types/forumTypes';\n  import { createForumPost } from '$lib/services/forums/forumService';\n  import { getAuth } from 'firebase/auth';\n  \n  export let topicId: string;\n  \n  let newPostContent = '';\n  let isSubmitting = false;\n  let submitError: string | null = null;\n  let isAuthenticated = false;\n  \n  onMount(() => {\n    const auth = getAuth();\n    isAuthenticated = !!auth.currentUser;\n    \n    loadTopic(topicId);\n    \n    const unsubscribe = auth.onAuthStateChanged((user) => {\n      isAuthenticated = !!user;\n    });\n    \n    return unsubscribe;\n  });\n  \n  async function handleSubmitPost() {\n    if (!newPostContent.trim() || !isAuthenticated) return;\n    \n    isSubmitting = true;\n    submitError = null;\n    \n    try {\n      const newPost = await createForumPost({\n        topic_id: topicId,\n        content: newPostContent,\n      } as Omit<ForumPost, 'id' | 'created_at'>);\n      \n      if (newPost) {\n        newPostContent = '';\n        // Reload the topic to get the new post\n        await loadTopic(topicId);\n      } else {\n        submitError = 'Failed to create post. Please try again.';\n      }\n    } catch (err) {\n      console.error('Error submitting post:', err);\n      submitError = 'An error occurred while submitting your post.';\n    } finally {\n      isSubmitting = false;\n    }\n  }\n  \n  function formatDate(date: Date | undefined): string {\n    if (!date) return 'Unknown date';\n    \n    const now = new Date();\n    const diff = now.getTime() - date.getTime();\n    \n    // Less than 24 hours\n    if (diff < 24 * 60 * 60 * 1000) {\n      const hours = Math.floor(diff / (60 * 60 * 1000));\n      \n      if (hours < 1) {\n        const minutes = Math.floor(diff / (60 * 1000));\n        return minutes < 1 ? 'Just now' : `${minutes} minute${minutes !== 1 ? 's' : ''} ago`;\n      }\n      \n      return `${hours} hour${hours !== 1 ? 's' : ''} ago`;\n    }\n    \n    // Less than 7 days\n    if (diff < 7 * 24 * 60 * 60 * 1000) {\n      const days = Math.floor(diff / (24 * 60 * 60 * 1000));\n      return `${days} day${days !== 1 ? 's' : ''} ago`;\n    }\n    \n    // Default to formatted date\n    return date.toLocaleDateString('en-US', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric'\n    });\n  }\n</script>\n\n<!-- Placeholder for ForumTopic.svelte -->\n\n<div class=\"forum-topic\">\n  {#if $isLoading}\n    <div class=\"flex justify-center items-center py-12\">\n      <div class=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-cherry-500\"></div>\n    </div>\n  {:else if $error}\n    <div class=\"bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-400 p-4 rounded-md mb-6\">\n      <p>{$error}</p>\n    </div>\n  {:else if $currentTopic}\n    <div class=\"mb-6\">\n      <a href=\"/forums/category/{$currentTopic.category_id}\" class=\"inline-flex items-center text-cherry-600 dark:text-cherry-400 hover:underline mb-4\">\n        <Icon icon=\"mdi:arrow-left\" class=\"w-5 h-5 mr-1\" />\n        Back to Forum\n      </a>\n      \n      <h1 class=\"text-2xl font-bold text-gray-900 dark:text-white mb-2\">{$currentTopic.title}</h1>\n      \n      <div class=\"flex items-center text-sm text-gray-600 dark:text-gray-400 mb-4\">\n        <span class=\"flex items-center\">\n          <Icon icon=\"mdi:account\" class=\"w-4 h-4 mr-1\" />\n          {$currentTopic.author_name || 'Unknown'}\n        </span>\n        <span class=\"mx-2\">•</span>\n        <span>{formatDate($currentTopic.created_at)}</span>\n        <span class=\"mx-2\">•</span>\n        <span class=\"flex items-center\">\n          <Icon icon=\"mdi:eye-outline\" class=\"w-4 h-4 mr-1\" />\n          {$currentTopic.views} view{$currentTopic.views !== 1 ? 's' : ''}\n        </span>\n        <span class=\"mx-2\">•</span>\n        <span class=\"flex items-center\">\n          <Icon icon=\"mdi:comment-outline\" class=\"w-4 h-4 mr-1\" />\n          {$currentTopic.post_count} repl{$currentTopic.post_count !== 1 ? 'ies' : 'y'}\n        </span>\n      </div>\n      \n      {#if $currentTopic.tags && $currentTopic.tags.length > 0}\n        <div class=\"flex flex-wrap gap-2 mb-4\">\n          {#each $currentTopic.tags as tag}\n            <a href=\"/forums/tag/{tag}\" class=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors\">\n              {tag}\n            </a>\n          {/each}\n        </div>\n      {/if}\n      \n      <div class=\"bg-white dark:bg-gray-800 rounded-lg shadow-md p-5 mb-6\">\n        <div class=\"prose dark:prose-invert max-w-none\">\n          <MarkdownRenderer content={$currentTopic.content} />\n        </div>\n      </div>\n      \n      <h2 class=\"text-xl font-semibold text-gray-900 dark:text-white mb-4\">\n        Replies ({$posts.length})\n      </h2>\n      \n      {#if $posts.length === 0}\n        <div class=\"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 text-center\">\n          <Icon icon=\"mdi:comment-text-outline\" class=\"w-12 h-12 mx-auto text-gray-400 mb-2\" />\n          <p class=\"text-gray-600 dark:text-gray-400\">No replies yet. Be the first to reply!</p>\n        </div>\n      {:else}\n        <div class=\"space-y-4\">\n          {#each $posts as post}\n            <div class=\"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden\">\n              <div class=\"p-5\">\n                <div class=\"flex items-start\">\n                  <div class=\"flex-shrink-0 mr-4\">\n                    {#if post.authorAvatar}\n                      <img src={post.authorAvatar} alt={post.author_name} class=\"w-10 h-10 rounded-full\" />\n                    {:else}\n                      <div class=\"w-10 h-10 rounded-full bg-cherry-100 dark:bg-cherry-900/30 flex items-center justify-center\">\n                        <span class=\"text-cherry-600 dark:text-cherry-400 text-lg font-medium\">\n                          {post.author_name?.charAt(0) || 'A'}\n                        </span>\n                      </div>\n                    {/if}\n                  </div>\n                  \n                  <div class=\"flex-1\">\n                    <div class=\"flex items-center justify-between mb-2\">\n                      <span class=\"font-medium text-gray-900 dark:text-white\">{post.author_name || 'Unknown'}</span>\n                      <span class=\"text-sm text-gray-500 dark:text-gray-400\">{formatDate(post.created_at)}</span>\n                    </div>\n                    \n                    <div class=\"prose dark:prose-invert max-w-none\">\n                      <MarkdownRenderer content={post.content} />\n                    </div>\n                    \n                    {#if post.is_answer}\n                      <div class=\"mt-3 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400\">\n                        <Icon icon=\"mdi:check-circle\" class=\"w-4 h-4 mr-1\" />\n                        Accepted Answer\n                      </div>\n                    {/if}\n                  </div>\n                </div>\n              </div>\n            </div>\n          {/each}\n        </div>\n      {/if}\n      \n      {#if !$currentTopic.is_locked}\n        <div class=\"mt-8\">\n          <h3 class=\"text-lg font-medium text-gray-900 dark:text-white mb-4\">Add Your Reply</h3>\n          \n          {#if isAuthenticated}\n            <div class=\"bg-white dark:bg-gray-800 rounded-lg shadow-md p-5\">\n              <textarea\n                bind:value={newPostContent}\n                placeholder=\"Write your reply here... (Markdown supported)\"\n                class=\"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-cherry-500 focus:border-cherry-500 dark:focus:ring-cherry-400 dark:focus:border-cherry-400 min-h-[150px]\"\n                disabled={isSubmitting}\n              ></textarea>\n              \n              {#if submitError}\n                <div class=\"text-red-600 dark:text-red-400 text-sm mt-2\">{submitError}</div>\n              {/if}\n              \n              <div class=\"flex justify-end mt-4\">\n                <button \n                  on:click={handleSubmitPost}\n                  disabled={isSubmitting || !newPostContent.trim()}\n                  class=\"px-4 py-2 bg-cherry-600 text-white rounded-md hover:bg-cherry-700 dark:bg-cherry-500 dark:hover:bg-cherry-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n                >\n                  {isSubmitting ? 'Submitting...' : 'Post Reply'}\n                </button>\n              </div>\n            </div>\n          {:else}\n            <div class=\"bg-gray-100 dark:bg-gray-800 rounded-lg p-5 text-center\">\n              <p class=\"text-gray-700 dark:text-gray-300 mb-3\">You need to be logged in to reply to this topic.</p>\n              <a href=\"/login\" class=\"inline-block px-4 py-2 bg-cherry-600 text-white rounded-md hover:bg-cherry-700 dark:bg-cherry-500 dark:hover:bg-cherry-600 transition-colors\">\n                Log In to Reply\n              </a>\n            </div>\n          {/if}\n        </div>\n      {:else}\n        <div class=\"mt-8 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4 text-center text-yellow-800 dark:text-yellow-400\">\n          <Icon icon=\"mdi:lock\" class=\"w-5 h-5 inline-block mr-2\" />\n          This topic is locked. New replies are not allowed.\n        </div>\n      {/if}\n    </div>\n  {:else if !$isLoading}\n    <div class=\"text-center py-12\">\n      <Icon icon=\"mdi:alert-circle-outline\" class=\"w-16 h-16 mx-auto text-gray-400 mb-4\" />\n      <h3 class=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">Topic not found</h3>\n      <p class=\"text-gray-600 dark:text-gray-400\">The topic you're looking for doesn't exist or has been removed.</p>\n      <a href=\"/forums\" class=\"inline-block mt-4 px-4 py-2 bg-cherry-600 text-white rounded-md hover:bg-cherry-700 dark:bg-cherry-500 dark:hover:bg-cherry-600 transition-colors\">\n        Back to Forums\n      </a>\n    </div>\n  {/if}\n</div>","<script lang=\"ts\">\n  import { onMount } from 'svelte';\n  import { page } from '$app/stores';\n  import ForumTopic from '$lib/components/forums/ForumTopic.svelte';\n  \n  const topicId = $page.params.id;\n</script>\n\n<div class=\"container mx-auto px-4 py-8\">\n  <ForumTopic {topicId} />\n</div>\n\n<style>\n  /* Add any component-specific styles here */\n</style>"],"names":["topicId","$.prop","$$props","newPostContent","isSubmitting","submitError","isAuthenticated","onMount","auth","getAuth","loadTopic","user","$.set","handleSubmitPost","__async","$.get","createForumPost","err","formatDate","date","diff","hours","minutes","days","$error","$currentTopic","$.index","$$anchor","tag","$$render","consequent_2","$.each","div_9","$posts","post","$.set_attribute","img","consequent_4","alternate_3","consequent_5","consequent_3","alternate_2","consequent_6","$.bind_value","textarea","$$value","consequent_7","alternate_4","alternate_5","consequent_8","a","_a","$.set_text","text_1","_b","_c","text_7","_d","$isLoading","consequent_10","consequent_9","alternate_6","consequent_1","alternate_1","consequent","alternate"],"mappings":"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"}