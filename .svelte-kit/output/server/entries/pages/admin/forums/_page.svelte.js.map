{"version":3,"file":"_page.svelte.js","sources":["../../../../../../../src/routes/admin/forums/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n  import { onMount } from 'svelte';\n  import { categories, loadCategories, isLoading, error } from '$lib/stores/forumStore';\n  import { createCategory, deleteCategory } from '$lib/services/forums/forumService';\n  import type { ForumCategory } from '$lib/types/forumTypes';\n  import Icon from '@iconify/svelte';\n  \n  let showCreateForm = false;\n  let newCategoryName = '';\n  let newCategoryDescription = '';\n  let newCategoryImageUrl = '';\n  \n  let isCreating = false;\n  let createError: string | null = null;\n  let createSuccess: string | null = null;\n  \n  onMount(() => {\n    loadCategories();\n  });\n  \n  function toggleCreateForm() {\n    showCreateForm = !showCreateForm;\n    if (!showCreateForm) {\n      newCategoryName = '';\n      newCategoryDescription = '';\n      newCategoryImageUrl = '';\n      createError = null;\n      createSuccess = null;\n    }\n  }\n  \n  async function handleCreateCategory() {\n    if (!newCategoryName.trim() || !newCategoryDescription.trim()) {\n      createError = 'Name and description are required';\n      return;\n    }\n    \n    isCreating = true;\n    createError = null;\n    createSuccess = null;\n    \n    try {\n      const newCategory = await createCategory({\n        name: newCategoryName.trim(),\n        description: newCategoryDescription.trim(),\n        ...(newCategoryImageUrl ? { imageUrl: newCategoryImageUrl.trim() } : {})\n      });\n      \n      if (newCategory) {\n        createSuccess = 'Category created successfully!';\n        newCategoryName = '';\n        newCategoryDescription = '';\n        newCategoryImageUrl = '';\n        \n        // Reload categories to include the new one\n        await loadCategories();\n        \n        setTimeout(() => {\n          showCreateForm = false;\n          createSuccess = null;\n        }, 1500);\n      } else {\n        createError = 'Failed to create category. Please try again.';\n      }\n    } catch (err) {\n      console.error('Error creating category:', err);\n      createError = 'An error occurred while creating the category.';\n    } finally {\n      isCreating = false;\n    }\n  }\n  \n  async function handleDeleteCategory(categoryId: string) {\n    if (!confirm('Are you sure you want to delete this category? This will also delete all topics in this category and cannot be undone.')) {\n      return;\n    }\n    \n    try {\n      const result = await deleteCategory(categoryId);\n      \n      if (result) {\n        await loadCategories();\n      } else {\n        alert('Failed to delete category. Please try again.');\n      }\n    } catch (err) {\n      console.error('Error deleting category:', err);\n      alert('An error occurred while deleting the category.');\n    }\n  }\n</script>\n\n<div class=\"container mx-auto px-4 py-8\">\n  <div class=\"flex justify-between items-center mb-6\">\n    <h1 class=\"text-2xl font-bold text-gray-900 dark:text-white\">Forum Administration</h1>\n    \n    <button \n      on:click={toggleCreateForm}\n      class=\"px-4 py-2 bg-cherry-600 text-white rounded-md hover:bg-cherry-700 dark:bg-cherry-500 dark:hover:bg-cherry-600 transition-colors\"\n    >\n      {showCreateForm ? 'Cancel' : 'Create Category'}\n    </button>\n  </div>\n  \n  {#if showCreateForm}\n    <div class=\"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-8\">\n      <h2 class=\"text-xl font-semibold text-gray-900 dark:text-white mb-4\">Create New Category</h2>\n      \n      {#if createError}\n        <div class=\"bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-400 p-4 rounded-md mb-6\">\n          <p>{createError}</p>\n        </div>\n      {/if}\n      \n      {#if createSuccess}\n        <div class=\"bg-green-100 dark:bg-green-900/20 text-green-700 dark:text-green-400 p-4 rounded-md mb-6\">\n          <p>{createSuccess}</p>\n        </div>\n      {/if}\n      \n      <div class=\"space-y-4\">\n        <div>\n          <label for=\"name\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n            Name *\n          </label>\n          <input\n            type=\"text\"\n            id=\"name\"\n            bind:value={newCategoryName}\n            placeholder=\"e.g., General Discussion\"\n            class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-cherry-500 focus:border-cherry-500 dark:focus:ring-cherry-400 dark:focus:border-cherry-400\"\n            disabled={isCreating}\n          />\n        </div>\n        \n        <div>\n          <label for=\"description\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n            Description *\n          </label>\n          <textarea\n            id=\"description\"\n            bind:value={newCategoryDescription}\n            placeholder=\"A short description of what this category is for.\"\n            class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-cherry-500 focus:border-cherry-500 dark:focus:ring-cherry-400 dark:focus:border-cherry-400 min-h-[100px]\"\n            disabled={isCreating}\n          ></textarea>\n        </div>\n        \n        <div>\n          <label for=\"imageUrl\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n            Image URL (optional)\n          </label>\n          <input\n            type=\"text\"\n            id=\"imageUrl\"\n            bind:value={newCategoryImageUrl}\n            placeholder=\"https://example.com/image.jpg\"\n            class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-cherry-500 focus:border-cherry-500 dark:focus:ring-cherry-400 dark:focus:border-cherry-400\"\n            disabled={isCreating}\n          />\n        </div>\n        \n        <div class=\"flex justify-end\">\n          <button \n            on:click={handleCreateCategory}\n            disabled={isCreating || !newCategoryName.trim() || !newCategoryDescription.trim()}\n            class=\"px-4 py-2 bg-cherry-600 text-white rounded-md hover:bg-cherry-700 dark:bg-cherry-500 dark:hover:bg-cherry-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n          >\n            {isCreating ? 'Creating...' : 'Create Category'}\n          </button>\n        </div>\n      </div>\n    </div>\n  {/if}\n  \n  <h2 class=\"text-xl font-semibold text-gray-900 dark:text-white mb-4\">Forum Categories</h2>\n  \n  {#if $isLoading}\n    <div class=\"flex justify-center items-center py-12\">\n      <div class=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-cherry-500\"></div>\n    </div>\n  {:else if $error}\n    <div class=\"bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-400 p-4 rounded-md mb-6\">\n      <p>{$error}</p>\n    </div>\n  {:else if $categories.length === 0}\n    <div class=\"text-center py-12 bg-white dark:bg-gray-800 rounded-lg shadow-md\">\n      <Icon icon=\"mdi:forum-outline\" class=\"w-16 h-16 mx-auto text-gray-400 mb-4\" />\n      <h3 class=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">No categories found</h3>\n      <p class=\"text-gray-600 dark:text-gray-400\">\n        There are no forum categories yet. Create your first category to get started.\n      </p>\n    </div>\n  {:else}\n    <div class=\"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden\">\n      <table class=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n        <thead class=\"bg-gray-50 dark:bg-gray-900\">\n          <tr>\n            <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n              Name\n            </th>\n            <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n              Description\n            </th>\n            <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n              Topics\n            </th>\n            <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n              Order\n            </th>\n            <th scope=\"col\" class=\"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n              Actions\n            </th>\n          </tr>\n        </thead>\n        <tbody class=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n          {#each $categories as category}\n            <tr class=\"hover:bg-gray-50 dark:hover:bg-gray-750\">\n              <td class=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white\">\n                {category.name}\n              </td>\n              <td class=\"px-6 py-4 text-sm text-gray-600 dark:text-gray-300 truncate max-w-[300px]\">\n                {category.description}\n              </td>\n              <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300\">\n                {category.topicCount || 0}\n              </td>\n              <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300\">\n                {category.order ?? 'N/A'}\n              </td>\n              <td class=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                <div class=\"flex justify-end space-x-2\">\n                  <a \n                    href=\"/admin/forums/category/{category.id}/edit\" \n                    class=\"text-cherry-600 dark:text-cherry-400 hover:text-cherry-900 dark:hover:text-cherry-300\"\n                    title=\"Edit category\"\n                  >\n                    <Icon icon=\"mdi:pencil\" class=\"w-5 h-5\" />\n                  </a>\n                  <button \n                    on:click={() => handleDeleteCategory(category.id)}\n                    class=\"text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300\"\n                    title=\"Delete category\"\n                  >\n                    <Icon icon=\"mdi:delete\" class=\"w-5 h-5\" />\n                  </button>\n                </div>\n              </td>\n            </tr>\n          {/each}\n        </tbody>\n      </table>\n    </div>\n  {/if}\n</div>"],"names":["$.store_get","$.escape","$.attr","$.stringify"],"mappings":";;;;;;;;sWAoGmC,iBAAiB,CAAA;;;;;;;;;;;EAqF5B,WAAAA,UAAA,iBAAA,CAAA,GAAA,eAAA,UAAA,EAAA,WAAW,GAAC;;;;;;;;;;;;;UA+BJ,WAAQ,WAAA,OAAA;oLAGvB,SAAS,IAAI,CAGb,8FAAAC,YAAA,SAAS,WAAW,CAAA,yFAAAA,YAGpB,SAAS,cAAc,CAAC,CAAA,yFAAAA,YAGxB,SAAS,SAAS,KAAK,CAAA,yHAAAC,KAAA,QAAA,0BAAAC,UAKU,SAAS,EAAE,CAAA,OAAA,CAAA;;;;;;;;;;;;"}