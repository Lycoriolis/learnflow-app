{"version":3,"file":"_page.svelte.js","sources":["../../../../../../../src/routes/tools/pomodoro/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n  import { onMount, onDestroy } from 'svelte';\n  import { tick } from 'svelte';\n  import { logStart, logEnd, logEvent } from '$lib/services/activityService';\n\n  // Pomodoro settings\n  const WORK_MIN = 25;\n  const BREAK_MIN = 5;\n  const LONG_BREAK_MIN = 15;\n  const CYCLES_BEFORE_LONG = 4;\n\n  let minutes = WORK_MIN;\n  let seconds = 0;\n  let isRunning = false;\n  let isWork = true;\n  let cycle = 1;\n  let interval: any = null;\n  let completedCycles = 0;\n  let showConfetti = false;\n  let pomodoroEventId: string | null = null;\n\n  onMount(async () => {\n    pomodoroEventId = await logStart('view_pomodoro', 'pomodoro');\n    resetTimer();\n  });\n\n  onDestroy(() => {\n    if (pomodoroEventId) logEnd(pomodoroEventId);\n  });\n\n  function startTimer() {\n    logEvent('start_pomodoro', 'pomodoro');\n    if (!isRunning) {\n      isRunning = true;\n      interval = setInterval(tickTimer, 1000);\n    }\n  }\n\n  function pauseTimer() {\n    logEvent('pause_pomodoro', 'pomodoro');\n    isRunning = false;\n    clearInterval(interval);\n  }\n\n  function resetTimer() {\n    logEvent('reset_pomodoro', 'pomodoro');\n    pauseTimer();\n    minutes = isWork ? WORK_MIN : (cycle % CYCLES_BEFORE_LONG === 0 ? LONG_BREAK_MIN : BREAK_MIN);\n    seconds = 0;\n  }\n\n  async function completeSession() {\n    logEvent('complete_session', 'pomodoro', { isWork });\n    pauseTimer();\n    showConfetti = true;\n    await tick();\n    setTimeout(() => showConfetti = false, 2000);\n    if (isWork) {\n      completedCycles++;\n      isWork = false;\n      minutes = (cycle % CYCLES_BEFORE_LONG === 0) ? LONG_BREAK_MIN : BREAK_MIN;\n      cycle++;\n    } else {\n      isWork = true;\n      minutes = WORK_MIN;\n    }\n    seconds = 0;\n  }\n\n  function tickTimer() {\n    if (seconds === 0) {\n      if (minutes === 0) {\n        completeSession();\n        return;\n      } else {\n        minutes--;\n        seconds = 59;\n      }\n    } else {\n      seconds--;\n    }\n  }\n\n  // Format time as MM:SS\n  $: timeStr = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;\n</script>\n\n<svelte:head>\n  <title>Pomodoro Timer | LearnFlow</title>\n</svelte:head>\n\n<div class=\"flex flex-col items-center justify-center min-h-[60vh] py-10\">\n  <div class=\"relative mb-8\">\n    <!-- Animated tomato/progress ring -->\n    <svg width=\"180\" height=\"180\" viewBox=\"0 0 180 180\">\n      <circle cx=\"90\" cy=\"90\" r=\"80\" fill=\"#f3f4f6\" />\n      <circle\n        cx=\"90\" cy=\"90\" r=\"80\"\n        fill=\"none\" stroke=\"#f87171\" stroke-width=\"14\"\n        stroke-dasharray=\"502\"\n        stroke-dashoffset={isWork ? 502 - (502 * ((WORK_MIN*60 - (minutes*60+seconds)) / (WORK_MIN*60))) : 502 - (502 * ((cycle % CYCLES_BEFORE_LONG === 0 ? LONG_BREAK_MIN : BREAK_MIN)*60 - (minutes*60+seconds)) / ((cycle % CYCLES_BEFORE_LONG === 0 ? LONG_BREAK_MIN : BREAK_MIN)*60))}\n        stroke-linecap=\"round\"\n        style=\"transition: stroke-dashoffset 0.5s linear;\"\n      />\n      <!-- Tomato face -->\n      <circle cx=\"90\" cy=\"90\" r=\"60\" fill=\"#f87171\" />\n      <ellipse cx=\"90\" cy=\"70\" rx=\"18\" ry=\"10\" fill=\"#34d399\" />\n      <ellipse cx=\"80\" cy=\"100\" rx=\"6\" ry=\"8\" fill=\"#fff\" />\n      <ellipse cx=\"100\" cy=\"100\" rx=\"6\" ry=\"8\" fill=\"#fff\" />\n      <ellipse cx=\"80\" cy=\"102\" rx=\"2\" ry=\"3\" fill=\"#222\" />\n      <ellipse cx=\"100\" cy=\"102\" rx=\"2\" ry=\"3\" fill=\"#222\" />\n      <path d=\"M80 115 Q90 125 100 115\" stroke=\"#222\" stroke-width=\"3\" fill=\"none\" />\n    </svg>\n    {#if showConfetti}\n      <div class=\"absolute inset-0 flex items-center justify-center pointer-events-none animate-bounce\">\n        <span class=\"text-5xl\">üéâ</span>\n      </div>\n    {/if}\n    <div class=\"absolute inset-0 flex flex-col items-center justify-center\">\n      <span class=\"text-5xl font-mono font-bold text-gray-900 dark:text-white drop-shadow\">{timeStr}</span>\n      <span class=\"mt-2 text-lg font-semibold {isWork ? 'text-red-500' : 'text-green-500'}\">\n        {isWork ? 'Work' : (cycle % CYCLES_BEFORE_LONG === 0 ? 'Long Break' : 'Break')}\n      </span>\n    </div>\n  </div>\n  <div class=\"flex space-x-4 mb-6\">\n    <button class=\"px-6 py-2 rounded-lg bg-indigo-600 text-white font-bold shadow hover:bg-indigo-700 transition\" on:click={startTimer} disabled={isRunning}>\n      <i class=\"fas fa-play mr-2\"></i> Start\n    </button>\n    <button class=\"px-6 py-2 rounded-lg bg-yellow-400 text-white font-bold shadow hover:bg-yellow-500 transition\" on:click={pauseTimer} disabled={!isRunning}>\n      <i class=\"fas fa-pause mr-2\"></i> Pause\n    </button>\n    <button class=\"px-6 py-2 rounded-lg bg-gray-300 text-gray-700 font-bold shadow hover:bg-gray-400 transition\" on:click={resetTimer}>\n      <i class=\"fas fa-redo mr-2\"></i> Reset\n    </button>\n  </div>\n  <div class=\"flex items-center space-x-6 mt-2\">\n    <span class=\"text-sm text-gray-500\">Cycle: <span class=\"font-bold text-indigo-600\">{cycle}</span></span>\n    <span class=\"text-sm text-gray-500\">Completed: <span class=\"font-bold text-green-500\">{completedCycles}</span></span>\n  </div>\n  <div class=\"mt-8 text-center text-gray-400 text-xs\">\n    <span>Stay focused! Every 4 cycles, enjoy a longer break üçÖ</span>\n  </div>\n</div>\n\n<style>\n  .animate-bounce {\n    animation: bounce 1s infinite alternate;\n  }\n  @keyframes bounce {\n    0% { transform: translateY(0); }\n    100% { transform: translateY(-20px); }\n  }\n</style>\n"],"names":["$.attr_class","$.stringify","$.escape","$.attr"],"mappings":";;;;;;MAoFK;AA9EG,QAAA,WAAW;AAKb,MAAA,UAAU;AACV,MAAA,UAAU;AACV,MAAA,YAAY;AAEZ,MAAA,QAAQ;AAER,MAAA,kBAAkB;AAStB,YAAgB,MAAA;AAAA,GAEf;AAwDE,eAAa,QAAQ,SAAQ,EAAG,SAAS,GAAG,GAAG,CAAK,IAAA,QAAQ,SAAQ,EAAG,SAAS,GAAG,GAAG,CAAA;;;;gbAgBvD,MAAO,QAAQ,WAAS,MAAM,UAAQ,KAAG,aAAa,WAAS,IAAsL,CAAA;;;;sOAmB7L,OAAO,CAAA,gBAAAA,WAAA,8BAAAC,UAC3C,cAAiC,CAAA,IAAA,gBAAA,CAAA,IAAAC,YACvE,MAAmE,CAAA,mMAAAC,KAAA,YAK6D,WAAS,IAAA,CAAA,+LAAAA,KAAA,YAAA,MAGC,IAAA,CAAA,mbAAAD,YAQpE,KAAK,CAAA,sIAAAA,YACF,eAAe,CAAA;;;"}