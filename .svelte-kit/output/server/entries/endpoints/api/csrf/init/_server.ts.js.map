{"version":3,"file":"_server.ts.js","sources":["../../../../../../../../src/routes/api/csrf/init/+server.ts"],"sourcesContent":["/**\n * CSRF token initialization endpoint\n * \n * Generates a new CSRF token and returns it in the response headers\n */\nimport { json } from '@sveltejs/kit';\nimport type { RequestHandler } from '@sveltejs/kit';\nimport { setupCsrfToken } from '$lib/utils/csrf.server.js';\nimport { CSRF_HEADER } from '$lib/utils/csrf.types.js';\n\n// Server-side only check\nif (typeof window !== 'undefined') {\n  throw new Error('This endpoint should only be imported on the server!');\n}\n\nexport const GET: RequestHandler = async ({ cookies }) => {\n  // Generate a new CSRF token using our standard utility\n  const token = setupCsrfToken(cookies);\n  \n  // Return the token in both the response headers and body\n  return new Response(JSON.stringify({ token }), {\n    status: 200,\n    headers: {\n      [CSRF_HEADER]: token\n    }\n  });\n};"],"names":[],"mappings":";;AAWA,IAAI,OAAO,WAAW,aAAa;AAC3B,QAAA,IAAI,MAAM,sDAAsD;AACxE;AAEO,MAAM,MAAsB,OAAO,EAAE,cAAc;AAElD,QAAA,QAAQ,eAAe,OAAO;AAGpC,SAAO,IAAI,SAAS,KAAK,UAAU,EAAE,MAAO,CAAA,GAAG;AAAA,IAC7C,QAAQ;AAAA,IACR,SAAS;AAAA,MACP,CAAC,WAAW,GAAG;AAAA,IAAA;AAAA,EACjB,CACD;AACH;"}