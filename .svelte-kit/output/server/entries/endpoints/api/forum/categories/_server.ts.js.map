{"version":3,"file":"_server.ts.js","sources":["../../../../../../../../src/routes/api/forum/categories/+server.ts"],"sourcesContent":["import type { RequestHandler } from '@sveltejs/kit';\nimport { createCategory, getCategories, updateCategory, deleteCategory } from '$lib/services/forums/forumService';\n\nexport const GET: RequestHandler = async () => {\n  try {\n    const categories = await getCategories();\n    return new Response(JSON.stringify(categories), { status: 200 });\n  } catch (error) {\n    console.error('Error fetching categories:', error);\n    return new Response('Failed to fetch categories', { status: 500 });\n  }\n};\n\nexport const POST: RequestHandler = async ({ request }) => {\n  const data = await request.json();\n  \n  try {\n    if (!data.name || !data.description || !data.icon || !data.color) {\n      return new Response('Missing required fields', { status: 400 });\n    }\n    \n    const newCategory = await createCategory(data);\n    return new Response(JSON.stringify(newCategory), { status: 201 });\n  } catch (error) {\n    console.error('Error creating category:', error);\n    return new Response('Failed to create category', { status: 500 });\n  }\n};\n\nexport const PUT: RequestHandler = async ({ request }) => {\n  const { id, ...data } = await request.json();\n\n  if (!id) {\n    return new Response('Category ID is required', { status: 400 });\n  }\n\n  try {\n    const updated = await updateCategory(id, data);\n    // Handle the possibility that the category might not be found\n    if (updated === null) {\n      return new Response('Category not found', { status: 404 });\n    }\n    return new Response(JSON.stringify(updated), { status: 200 });\n  } catch (error) {\n    console.error('Error updating category:', error);\n    return new Response('Failed to update category', { status: 500 });\n  }\n};\n\nexport const DELETE: RequestHandler = async ({ url }) => {\n  const id = url.searchParams.get('id');\n\n  if (!id) {\n    return new Response('Category ID is required', { status: 400 });\n  }\n\n  try {\n    const result = await deleteCategory(id);\n    // Explicitly check for boolean value\n    if (result === false) {\n      return new Response('Category not found', { status: 404 });\n    }\n    return new Response(JSON.stringify({ success: true }), { status: 200 });\n  } catch (error) {\n    if (error instanceof Error && error.message === 'Cannot delete category with topics') {\n      return new Response('Cannot delete category that contains topics', { status: 400 });\n    }\n    console.error('Error deleting category:', error);\n    return new Response('Failed to delete category', { status: 500 });\n  }\n};"],"names":[],"mappings":";AAGO,MAAM,MAAsB,YAAY;AACzC,MAAA;AACI,UAAA,aAAa,MAAM,cAAc;AAChC,WAAA,IAAI,SAAS,KAAK,UAAU,UAAU,GAAG,EAAE,QAAQ,KAAK;AAAA,WACxD,OAAO;AACN,YAAA,MAAM,8BAA8B,KAAK;AACjD,WAAO,IAAI,SAAS,8BAA8B,EAAE,QAAQ,KAAK;AAAA,EAAA;AAErE;AAEO,MAAM,OAAuB,OAAO,EAAE,cAAc;AACnD,QAAA,OAAO,MAAM,QAAQ,KAAK;AAE5B,MAAA;AACE,QAAA,CAAC,KAAK,QAAQ,CAAC,KAAK,eAAe,CAAC,KAAK,QAAQ,CAAC,KAAK,OAAO;AAChE,aAAO,IAAI,SAAS,2BAA2B,EAAE,QAAQ,KAAK;AAAA,IAAA;AAG1D,UAAA,cAAc,MAAM,eAAe,IAAI;AACtC,WAAA,IAAI,SAAS,KAAK,UAAU,WAAW,GAAG,EAAE,QAAQ,KAAK;AAAA,WACzD,OAAO;AACN,YAAA,MAAM,4BAA4B,KAAK;AAC/C,WAAO,IAAI,SAAS,6BAA6B,EAAE,QAAQ,KAAK;AAAA,EAAA;AAEpE;AAEO,MAAM,MAAsB,OAAO,EAAE,cAAc;AACxD,QAAM,EAAE,IAAI,GAAG,KAAS,IAAA,MAAM,QAAQ,KAAK;AAE3C,MAAI,CAAC,IAAI;AACP,WAAO,IAAI,SAAS,2BAA2B,EAAE,QAAQ,KAAK;AAAA,EAAA;AAG5D,MAAA;AACF,UAAM,UAAU,MAAM,eAAe,IAAI,IAAI;AAE7C,QAAI,YAAY,MAAM;AACpB,aAAO,IAAI,SAAS,sBAAsB,EAAE,QAAQ,KAAK;AAAA,IAAA;AAEpD,WAAA,IAAI,SAAS,KAAK,UAAU,OAAO,GAAG,EAAE,QAAQ,KAAK;AAAA,WACrD,OAAO;AACN,YAAA,MAAM,4BAA4B,KAAK;AAC/C,WAAO,IAAI,SAAS,6BAA6B,EAAE,QAAQ,KAAK;AAAA,EAAA;AAEpE;AAEO,MAAM,SAAyB,OAAO,EAAE,UAAU;AACvD,QAAM,KAAK,IAAI,aAAa,IAAI,IAAI;AAEpC,MAAI,CAAC,IAAI;AACP,WAAO,IAAI,SAAS,2BAA2B,EAAE,QAAQ,KAAK;AAAA,EAAA;AAG5D,MAAA;AACI,UAAA,SAAS,MAAM,eAAe,EAAE;AAEtC,QAAI,WAAW,OAAO;AACpB,aAAO,IAAI,SAAS,sBAAsB,EAAE,QAAQ,KAAK;AAAA,IAAA;AAE3D,WAAO,IAAI,SAAS,KAAK,UAAU,EAAE,SAAS,KAAK,CAAC,GAAG,EAAE,QAAQ,KAAK;AAAA,WAC/D,OAAO;AACd,QAAI,iBAAiB,SAAS,MAAM,YAAY,sCAAsC;AACpF,aAAO,IAAI,SAAS,+CAA+C,EAAE,QAAQ,KAAK;AAAA,IAAA;AAE5E,YAAA,MAAM,4BAA4B,KAAK;AAC/C,WAAO,IAAI,SAAS,6BAA6B,EAAE,QAAQ,KAAK;AAAA,EAAA;AAEpE;"}